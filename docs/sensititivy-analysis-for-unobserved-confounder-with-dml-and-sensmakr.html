<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr | Machine Learning and Causal Inference</title>
  <meta name="description" content="Chapter 19 Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr | Machine Learning and Causal Inference" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr | Machine Learning and Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr | Machine Learning and Causal Inference" />
  
  
  

<meta name="author" content="Alexander Quispe &amp; Anzony Quispe" />


<meta name="date" content="2021-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"/>
<link rel="next" href="doubledebiased-ml-for-partially-linear-iv-model.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Machine Learning and Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="predictive-inference.html"><a href="predictive-inference.html"><i class="fa fa-check"></i><b>2</b> Predictive Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="predictive-inference.html"><a href="predictive-inference.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="predictive-inference.html"><a href="predictive-inference.html#data-analysis"><i class="fa fa-check"></i><b>2.2</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="predictive-inference.html"><a href="predictive-inference.html#r-and-python-code"><i class="fa fa-check"></i><b>2.2.1</b> R and Python code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="predictive-inference.html"><a href="predictive-inference.html#prediction-question"><i class="fa fa-check"></i><b>2.3</b> Prediction Question</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="predictive-inference.html"><a href="predictive-inference.html#basic-model"><i class="fa fa-check"></i><b>2.3.1</b> Basic Model:</a></li>
<li class="chapter" data-level="2.3.2" data-path="predictive-inference.html"><a href="predictive-inference.html#flexible-model"><i class="fa fa-check"></i><b>2.3.2</b> Flexible Model:</a></li>
<li class="chapter" data-level="2.3.3" data-path="predictive-inference.html"><a href="predictive-inference.html#lasso-model"><i class="fa fa-check"></i><b>2.3.3</b> Lasso Model:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="predictive-inference.html"><a href="predictive-inference.html#data-splitting"><i class="fa fa-check"></i><b>2.4</b> Data Splitting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html"><i class="fa fa-check"></i><b>3</b> Predictive Inference The Gender Wage Gap</a>
<ul>
<li class="chapter" data-level="3.1" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#data-analysis-1"><i class="fa fa-check"></i><b>3.1</b> Data analysis</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#ols-regression"><i class="fa fa-check"></i><b>3.1.1</b> OLS Regression</a></li>
<li class="chapter" data-level="3.1.2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#ols-regression-with-controls"><i class="fa fa-check"></i><b>3.1.2</b> Ols regression with controls</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#partialling-out-using-ols"><i class="fa fa-check"></i><b>3.2</b> Partialling-Out using ols</a></li>
<li class="chapter" data-level="3.3" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#partialling-out-using-lasso"><i class="fa fa-check"></i><b>3.3</b> Partialling-Out using lasso</a></li>
<li class="chapter" data-level="3.4" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#extra-flexible-model"><i class="fa fa-check"></i><b>3.4</b> “Extra” flexible model</a></li>
<li class="chapter" data-level="3.5" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#laso-extra-flexible-model"><i class="fa fa-check"></i><b>3.5</b> Laso “Extra” Flexible model</a></li>
<li class="chapter" data-level="3.6" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#summarize-the-results"><i class="fa fa-check"></i><b>3.6</b> Summarize the results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html"><i class="fa fa-check"></i><b>4</b> Simple Exercise on Overfitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#first-set-pn"><i class="fa fa-check"></i><b>4.1</b> 1. First set p=n</a></li>
<li class="chapter" data-level="4.2" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#second-set-pn2."><i class="fa fa-check"></i><b>4.2</b> 2. Second, set p=n/2.</a></li>
<li class="chapter" data-level="4.3" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#third-set-pn-.05"><i class="fa fa-check"></i><b>4.3</b> 3. Third, set p/n =.05</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vaccine-rct-examples.html"><a href="vaccine-rct-examples.html"><i class="fa fa-check"></i><b>5</b> Vaccine RCT Examples</a>
<ul>
<li class="chapter" data-level="5.1" data-path="vaccine-rct-examples.html"><a href="vaccine-rct-examples.html#polio-rct"><i class="fa fa-check"></i><b>5.1</b> Polio RCT</a></li>
<li class="chapter" data-level="5.2" data-path="vaccine-rct-examples.html"><a href="vaccine-rct-examples.html#pfizerbntx-covid-19-rct"><i class="fa fa-check"></i><b>5.2</b> Pfizer/BNTX Covid-19 RCT</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="penalized-linear-regressions-a-simulation-experiment.html"><a href="penalized-linear-regressions-a-simulation-experiment.html"><i class="fa fa-check"></i><b>6</b> Penalized Linear Regressions: A Simulation Experiment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="penalized-linear-regressions-a-simulation-experiment.html"><a href="penalized-linear-regressions-a-simulation-experiment.html#data-generating-process-approximately-sparse"><i class="fa fa-check"></i><b>6.1</b> Data Generating Process: Approximately Sparse</a></li>
<li class="chapter" data-level="6.2" data-path="penalized-linear-regressions-a-simulation-experiment.html"><a href="penalized-linear-regressions-a-simulation-experiment.html#data-generating-process-approximately-sparse-small-dense-part"><i class="fa fa-check"></i><b>6.2</b> Data Generating Process: Approximately Sparse + Small Dense Part</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-design.html"><a href="simulation-design.html"><i class="fa fa-check"></i><b>7</b> Simulation Design</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-design.html"><a href="simulation-design.html#example-1"><i class="fa fa-check"></i><b>7.1</b> Example 1</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-design.html"><a href="simulation-design.html#example-2"><i class="fa fa-check"></i><b>7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html"><i class="fa fa-check"></i><b>8</b> Testing the Convergence Hypothesis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#data-analysis-2"><i class="fa fa-check"></i><b>8.2</b> Data analysis</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#ols"><i class="fa fa-check"></i><b>8.2.1</b> OLS</a></li>
<li class="chapter" data-level="8.2.2" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#lasso"><i class="fa fa-check"></i><b>8.2.2</b> Lasso</a></li>
<li class="chapter" data-level="8.2.3" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#summary-results"><i class="fa fa-check"></i><b>8.2.3</b> Summary results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html"><i class="fa fa-check"></i><b>9</b> Machine Learning for wage prediction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#data-1"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#analysis"><i class="fa fa-check"></i><b>9.2</b> Analysis</a></li>
<li class="chapter" data-level="9.3" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#ols-1"><i class="fa fa-check"></i><b>9.3</b> OLS</a></li>
<li class="chapter" data-level="9.4" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#lasso-ridge-and-elastic-net"><i class="fa fa-check"></i><b>9.4</b> Lasso, Ridge and Elastic Net</a></li>
<li class="chapter" data-level="9.5" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#non-linear-models"><i class="fa fa-check"></i><b>9.5</b> Non-linear models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#regression-trees"><i class="fa fa-check"></i><b>9.5.1</b> Regression Trees</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#random-forest-and-boosted-trees"><i class="fa fa-check"></i><b>9.6</b> Random Forest and Boosted Trees</a></li>
<li class="chapter" data-level="9.7" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#results"><i class="fa fa-check"></i><b>9.7</b> Results</a></li>
<li class="chapter" data-level="9.8" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#ensemble-learning"><i class="fa fa-check"></i><b>9.8</b> Ensemble learning</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="deep-neural-networks-for-wage-prediction.html"><a href="deep-neural-networks-for-wage-prediction.html"><i class="fa fa-check"></i><b>10</b> Deep Neural Networks for Wage Prediction</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deep-neural-networks-for-wage-prediction.html"><a href="deep-neural-networks-for-wage-prediction.html#data-preparation"><i class="fa fa-check"></i><b>10.1</b> Data Preparation</a></li>
<li class="chapter" data-level="10.2" data-path="deep-neural-networks-for-wage-prediction.html"><a href="deep-neural-networks-for-wage-prediction.html#neural-networks"><i class="fa fa-check"></i><b>10.2</b> Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html"><i class="fa fa-check"></i><b>11</b> Functional Approximations by Trees and Neural Networks</a>
<ul>
<li class="chapter" data-level="11.1" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#functional-approximation-by-a-tree"><i class="fa fa-check"></i><b>11.1</b> Functional Approximation by a Tree</a></li>
<li class="chapter" data-level="11.2" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#functional-approximation-by-rf"><i class="fa fa-check"></i><b>11.2</b> Functional Approximation by RF</a></li>
<li class="chapter" data-level="11.3" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#boosted-trees"><i class="fa fa-check"></i><b>11.3</b> Boosted Trees</a></li>
<li class="chapter" data-level="11.4" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#same-example-with-a-neural-network"><i class="fa fa-check"></i><b>11.4</b> Same Example with a Neural Network</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><i class="fa fa-check"></i><b>12</b> Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests</a>
<ul>
<li class="chapter" data-level="12.1" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#graph-generation-and-plotting"><i class="fa fa-check"></i><b>12.1</b> Graph Generation and Plotting</a></li>
<li class="chapter" data-level="12.2" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#report-relatives-of-x2"><i class="fa fa-check"></i><b>12.2</b> Report Relatives of X2</a></li>
<li class="chapter" data-level="12.3" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#find-paths-between-d-and-y"><i class="fa fa-check"></i><b>12.3</b> Find Paths Between D and Y</a></li>
<li class="chapter" data-level="12.4" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#list-all-testable-implications-of-the-model"><i class="fa fa-check"></i><b>12.4</b> List All Testable Implications of the Model</a></li>
<li class="chapter" data-level="12.5" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#identification-by-backdoor-list-minimal-adjustment-sets-to-identify-causal-effecs-d-to-y"><i class="fa fa-check"></i><b>12.5</b> Identification by Backdoor: List minimal adjustment sets to identify causal effecs <span class="math inline">\(D \to Y\)</span></a></li>
<li class="chapter" data-level="12.6" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#identification-via-swig-and-d-separation"><i class="fa fa-check"></i><b>12.6</b> Identification via SWIG and D-separation</a></li>
<li class="chapter" data-level="12.7" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#deduce-conditional-exogeneity-or-ignorability-by-d-separation"><i class="fa fa-check"></i><b>12.7</b> Deduce Conditional Exogeneity or Ignorability by D-separation</a></li>
<li class="chapter" data-level="12.8" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#print-all-average-effects-identifiable-by-conditioning"><i class="fa fa-check"></i><b>12.8</b> Print All Average Effects Identifiable by Conditioning</a></li>
<li class="chapter" data-level="12.9" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#equivalence-classes"><i class="fa fa-check"></i><b>12.9</b> Equivalence Classes</a></li>
<li class="chapter" data-level="12.10" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#example-of-testing-dag-validity"><i class="fa fa-check"></i><b>12.10</b> Example of Testing DAG Validity</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dosearch-for-causal-identification-in-dags.html"><a href="dosearch-for-causal-identification-in-dags.html"><i class="fa fa-check"></i><b>13</b> Dosearch for Causal Identification in DAGs</a></li>
<li class="chapter" data-level="14" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><i class="fa fa-check"></i><b>14</b> A Case Study: The Effect of Gun Ownership on Gun-Homicide Rates</a>
<ul>
<li class="chapter" data-level="14.1" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#data-2"><i class="fa fa-check"></i><b>14.1</b> Data</a></li>
<li class="chapter" data-level="14.2" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#preprocessing."><i class="fa fa-check"></i><b>14.2</b> Preprocessing.</a></li>
<li class="chapter" data-level="14.3" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#the-effect-of-gun-ownership"><i class="fa fa-check"></i><b>14.3</b> The effect of gun ownership</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#ols-2"><i class="fa fa-check"></i><b>14.3.1</b> OLS</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#dml-algorithm"><i class="fa fa-check"></i><b>14.4</b> DML algorithm</a></li>
<li class="chapter" data-level="14.5" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#lasso-1"><i class="fa fa-check"></i><b>14.5</b> Lasso</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#random-forest"><i class="fa fa-check"></i><b>14.5.1</b> Random Forest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><a href="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><i class="fa fa-check"></i><b>15</b> The Effect of Gun Ownership on Gun-Homicide Rates using DML for neural nets</a>
<ul>
<li class="chapter" data-level="15.1" data-path="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><a href="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html#dml-for-neural-nets"><i class="fa fa-check"></i><b>15.1</b> DML for neural nets</a></li>
<li class="chapter" data-level="15.2" data-path="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><a href="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html#estimating-the-effect-with-dlm-for-neural-nets"><i class="fa fa-check"></i><b>15.2</b> Estimating the effect with DLM for neural nets</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><i class="fa fa-check"></i><b>16</b> Inference on Predictive and Causal Effects in High-Dimensional Nonlinear Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#impact-of-401k-on-financial-wealth"><i class="fa fa-check"></i><b>16.1</b> Impact of 401(k) on Financial Wealth</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#data-3"><i class="fa fa-check"></i><b>16.1.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#double-ml-package"><i class="fa fa-check"></i><b>16.2</b> Double ML package</a></li>
<li class="chapter" data-level="16.3" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#estimating-the-ate-of-401k-eligibility-on-net-financial-assets"><i class="fa fa-check"></i><b>16.3</b> Estimating the ATE of 401(k) Eligibility on Net Financial Assets</a></li>
<li class="chapter" data-level="16.4" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#partially-linear-regression-models-plr"><i class="fa fa-check"></i><b>16.4</b> Partially Linear Regression Models (PLR)</a></li>
<li class="chapter" data-level="16.5" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#interactive-regression-model-irm"><i class="fa fa-check"></i><b>16.5</b> Interactive Regression Model (IRM)</a></li>
<li class="chapter" data-level="16.6" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#local-average-treatment-effects-of-401k-participation-on-net-financial-assets"><i class="fa fa-check"></i><b>16.6</b> Local Average Treatment Effects of 401(k) Participation on Net Financial Assets</a></li>
<li class="chapter" data-level="16.7" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#interactive-iv-model-iivm"><i class="fa fa-check"></i><b>16.7</b> Interactive IV Model (IIVM)</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><i class="fa fa-check"></i><b>17</b> Using Dagitty in the Analysis of Impact of 401(k) on Net Financial Wealth</a>
<ul>
<li class="chapter" data-level="17.1" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#graphs-for-401k-analsyis"><i class="fa fa-check"></i><b>17.1</b> Graphs for 401(K) Analsyis</a></li>
<li class="chapter" data-level="17.2" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#state-one-graph-where-f-determines-x-and-plot-it"><i class="fa fa-check"></i><b>17.2</b> State one graph (where F determines X) and plot it</a></li>
<li class="chapter" data-level="17.3" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#list-minimal-adjustment-sets-to-identify-causal-effecs-d-to-y"><i class="fa fa-check"></i><b>17.3</b> List minimal adjustment sets to identify causal effecs <span class="math inline">\(D \to Y\)</span></a></li>
<li class="chapter" data-level="17.4" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#what-is-the-underlying-principle"><i class="fa fa-check"></i><b>17.4</b> What is the underlying principle?</a></li>
<li class="chapter" data-level="17.5" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#another-graph-wherere-x-determine-f"><i class="fa fa-check"></i><b>17.5</b> Another Graph (wherere <span class="math inline">\(X\)</span> determine <span class="math inline">\(F\)</span>):</a></li>
<li class="chapter" data-level="17.6" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#one-more-graph-encompassing-previous-ones-where-f-x-are-jointly-determined-by-latent-factors-a.-we-can-allow-in-fact-the-whole-triple-d-f-x-to-be-jointly-determined-by-latent-factors-a."><i class="fa fa-check"></i><b>17.6</b> One more graph (encompassing previous ones), where (F, X) are jointly determined by latent factors <span class="math inline">\(A\)</span>. We can allow in fact the whole triple (D, F, X) to be jointly determined by latent factors <span class="math inline">\(A\)</span>.</a></li>
<li class="chapter" data-level="17.7" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#threat-to-idenitification-what-if-f-also-directly-affects-y-note-that-there-are-no-valid-adjustment-sets-in-this-case"><i class="fa fa-check"></i><b>17.7</b> Threat to Idenitification: What if <span class="math inline">\(F\)</span> also directly affects <span class="math inline">\(Y\)</span>? (Note that there are no valid adjustment sets in this case)</a></li>
<li class="chapter" data-level="17.8" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#introduce-match-amount-m-very-important-mediator-why-mediator.-m-is-not-observed.-luckily-adjusting-for-x-still-works-if-there-is-no-f-to-m-arrow."><i class="fa fa-check"></i><b>17.8</b> Introduce Match Amount <span class="math inline">\(M\)</span> (very important mediator, why mediator?). <span class="math inline">\(M\)</span> is not observed. Luckily adjusting for <span class="math inline">\(X\)</span> still works if there is no <span class="math inline">\(F \to M\)</span> arrow.</a></li>
<li class="chapter" data-level="17.9" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#if-there-is-f-to-m-arrow-then-adjusting-for-x-is-not-sufficient."><i class="fa fa-check"></i><b>17.9</b> If there is <span class="math inline">\(F \to M\)</span> arrow, then adjusting for <span class="math inline">\(X\)</span> is not sufficient.</a></li>
<li class="chapter" data-level="17.10" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#question"><i class="fa fa-check"></i><b>17.10</b> Question:</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"><a href="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"><i class="fa fa-check"></i><b>18</b> Double/Debiased Machine Learning for the Partially Linear Regression Model.</a>
<ul>
<li class="chapter" data-level="18.1" data-path="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"><a href="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html#dml-algorithm-1"><i class="fa fa-check"></i><b>18.1</b> DML algorithm</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><i class="fa fa-check"></i><b>19</b> Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#here-we-experiment-with-using-package-sensemakr-in-conjunction-with-debiased-ml"><i class="fa fa-check"></i><b>19.1</b> Here we experiment with using package “sensemakr” in conjunction with debiased ML</a></li>
<li class="chapter" data-level="19.2" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#we-will-work-on"><i class="fa fa-check"></i><b>19.2</b> We will work on:</a></li>
<li class="chapter" data-level="19.3" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#take-out-village-fixed-effects-and-run-basic-linear-analysis"><i class="fa fa-check"></i><b>19.3</b> Take out village fixed effects and run basic linear analysis</a></li>
<li class="chapter" data-level="19.4" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#we-first-use-lasso-for-partilling-out-controls"><i class="fa fa-check"></i><b>19.4</b> We first use Lasso for Partilling Out Controls</a></li>
<li class="chapter" data-level="19.5" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#manual-bias-analysis"><i class="fa fa-check"></i><b>19.5</b> Manual Bias Analysis</a></li>
<li class="chapter" data-level="19.6" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#bias-analysis-with-sensemakr"><i class="fa fa-check"></i><b>19.6</b> Bias Analysis with Sensemakr</a></li>
<li class="chapter" data-level="19.7" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#next-we-use-random-forest-as-ml-tool-for-partialling-out"><i class="fa fa-check"></i><b>19.7</b> Next We use Random Forest as ML tool for Partialling Out</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html"><i class="fa fa-check"></i><b>20</b> Double/Debiased ML for Partially Linear IV Model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#partially-linear-iv-model"><i class="fa fa-check"></i><b>20.1</b> Partially Linear IV Model</a></li>
<li class="chapter" data-level="20.2" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#example"><i class="fa fa-check"></i><b>20.2</b> Example</a></li>
<li class="chapter" data-level="20.3" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#plivm-in-residualized-form"><i class="fa fa-check"></i><b>20.3</b> PLIVM in Residualized Form</a></li>
<li class="chapter" data-level="20.4" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#dml-for-pliv-model"><i class="fa fa-check"></i><b>20.4</b> DML for PLIV Model</a></li>
<li class="chapter" data-level="20.5" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#emprical-example-acemoglu-jonsohn-robinson-aer."><i class="fa fa-check"></i><b>20.5</b> Emprical Example: Acemoglu, Jonsohn, Robinson (AER).</a></li>
<li class="chapter" data-level="20.6" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#examine-if-we-have-weak-instruments"><i class="fa fa-check"></i><b>20.6</b> Examine if we have weak instruments</a></li>
<li class="chapter" data-level="20.7" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#we-do-have-weak-instruments-because-t-stats-in-regression-tilde-d-sim-tilde-z-are-less-than-4-in-absolute-value"><i class="fa fa-check"></i><b>20.7</b> We do have weak instruments, because t-stats in regression <span class="math inline">\(\tilde D \sim \tilde Z\)</span> are less than 4 in absolute value</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><i class="fa fa-check"></i><b>21</b> A Simple Example of Properties of IV estimator when Instruments are Weak</a>
<ul>
<li class="chapter" data-level="21.1" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html#run-1000-trials-to-evaluate-distribution-of-the-iv-estimator"><i class="fa fa-check"></i><b>21.1</b> Run 1000 trials to evaluate distribution of the IV estimator</a></li>
<li class="chapter" data-level="21.2" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html#plot-the-actual-distribution-against-the-normal-approximation-based-on-strong-instrument-assumption"><i class="fa fa-check"></i><b>21.2</b> Plot the Actual Distribution against the Normal Approximation (based on Strong Instrument Assumption)</a></li>
<li class="chapter" data-level="21.3" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html#some-help-functions"><i class="fa fa-check"></i><b>21.3</b> Some Help Functions</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html"><i class="fa fa-check"></i><b>22</b> HTE I: Binary treatment</a>
<ul>
<li class="chapter" data-level="22.1" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#pre-specified-hypotheses"><i class="fa fa-check"></i><b>22.1</b> Pre-specified hypotheses</a></li>
<li class="chapter" data-level="22.2" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#data-driven-hypotheses"><i class="fa fa-check"></i><b>22.2</b> Data-driven hypotheses</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#via-causal-trees"><i class="fa fa-check"></i><b>22.2.1</b> Via causal trees</a></li>
<li class="chapter" data-level="22.2.2" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#via-grf"><i class="fa fa-check"></i><b>22.2.2</b> Via grf</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#further-reading"><i class="fa fa-check"></i><b>22.3</b> Further reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning and Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr" class="section level1" number="19">
<h1><span class="header-section-number">Chapter 19</span> Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr</h1>
<div id="here-we-experiment-with-using-package-sensemakr-in-conjunction-with-debiased-ml" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Here we experiment with using package “sensemakr” in conjunction with debiased ML</h2>
<p><img src="images/dml_figure_1.png" alt="sas_dml_figure1" />
<img src="images/dml_figure_2.png" alt="sas_dml_figure2" />
<img src="images/dml_figure_3.png" alt="sas_dml_figure2" />
<img src="images/dml_figure_4.png" alt="sas_dml_figure2" /></p>
</div>
<div id="we-will-work-on" class="section level2" number="19.2">
<h2><span class="header-section-number">19.2</span> We will work on:</h2>
<ul>
<li><p>Mimic the partialling out procedure with machine learning tools,</p></li>
<li><p>And invoke Sensmakr to compute <span class="math inline">\(\phi^2\)</span> and plot sensitivity results.</p></li>
</ul>
<style>
  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }
  .col3 {
    columns: 3 100px;
    -webkit-columns: 3 100px;
    -moz-columns: 3 100px;
  }
</style>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loads package</span></span>
<span id="cb1-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;sensemakr&quot;)</span></span>
<span id="cb1-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sensemakr)</span>
<span id="cb1-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># loads data</span></span>
<span id="cb1-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;darfur&quot;</span>)</span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb2-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>)</span>
<span id="cb2-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> sensemakr</span>
<span id="cb2-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> sensitivity_stats</span>
<span id="cb2-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> bias_functions</span>
<span id="cb2-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> ovb_bounds</span>
<span id="cb2-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> ovb_plots</span>
<span id="cb2-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb2-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb2-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># loads data</span></span>
<span id="cb2-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb2-14" aria-hidden="true" tabindex="-1"></a>darfur <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/darfur.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<p>Data is described here
<a href="https://cran.r-project.org/web/packages/sensemakr/vignettes/sensemakr.html" class="uri">https://cran.r-project.org/web/packages/sensemakr/vignettes/sensemakr.html</a></p>
<p>The main outcome is attitude towards peace – the peacefactor.
The key variable of interest is whether the responders were directly harmed (directlyharmed).
We want to know if being directly harmed in the conflict causes people to support peace-enforcing measures.
The measured confounders include female indicator, age, farmer, herder, voted in the past, and household size.
There is also a village indicator, which we will treat as fixed effect and partial it out before conducting
the analysis. The standard errors will be clustered at the village level.</p>
</div>
<div id="take-out-village-fixed-effects-and-run-basic-linear-analysis" class="section level2" number="19.3">
<h2><span class="header-section-number">19.3</span> Take out village fixed effects and run basic linear analysis</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get rid of village fixed effects</span></span>
<span id="cb3-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(darfur)</span>
<span id="cb3-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lfe)</span>
<span id="cb3-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-5" aria-hidden="true" tabindex="-1"></a>peacefactorR<span class="ot">&lt;-</span> <span class="fu">lm</span>(peacefactor<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-6" aria-hidden="true" tabindex="-1"></a>directlyharmedR<span class="ot">&lt;-</span>  <span class="fu">lm</span>(directlyharmed<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-7" aria-hidden="true" tabindex="-1"></a>femaleR<span class="ot">&lt;-</span>  <span class="fu">lm</span>(female<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-8" aria-hidden="true" tabindex="-1"></a>ageR<span class="ot">&lt;-</span>     <span class="fu">lm</span>(age<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-9" aria-hidden="true" tabindex="-1"></a>farmerR<span class="ot">&lt;-</span>  <span class="fu">lm</span>(farmer_dar<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-10" aria-hidden="true" tabindex="-1"></a>herderR<span class="ot">&lt;-</span>  <span class="fu">lm</span>(herder_dar<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-11" aria-hidden="true" tabindex="-1"></a>pastvotedR<span class="ot">&lt;-</span> <span class="fu">lm</span>(pastvoted<span class="sc">~</span>village)<span class="sc">$</span>res</span>
<span id="cb3-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb3-12" aria-hidden="true" tabindex="-1"></a>hhsizeR<span class="ot">&lt;-</span>   <span class="fu">lm</span>(hhsize_darfur<span class="sc">~</span>village)<span class="sc">$</span>res</span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of village fixed effects</span></span>
<span id="cb4-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb4-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb4-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-5" aria-hidden="true" tabindex="-1"></a>peacefactorR <span class="op">=</span> smf.ols(<span class="st">&#39;peacefactor~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-6" aria-hidden="true" tabindex="-1"></a>directlyharmedR <span class="op">=</span> smf.ols(<span class="st">&#39;directlyharmed~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-7" aria-hidden="true" tabindex="-1"></a>femaleR <span class="op">=</span> smf.ols(<span class="st">&#39;female~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-8" aria-hidden="true" tabindex="-1"></a>ageR <span class="op">=</span> smf.ols(<span class="st">&#39;age~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-9" aria-hidden="true" tabindex="-1"></a>farmerR <span class="op">=</span> smf.ols(<span class="st">&#39;farmer_dar~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-10" aria-hidden="true" tabindex="-1"></a>herderR <span class="op">=</span> smf.ols(<span class="st">&#39;herder_dar~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-11" aria-hidden="true" tabindex="-1"></a>pastvotedR <span class="op">=</span> smf.ols(<span class="st">&#39;pastvoted~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-12" aria-hidden="true" tabindex="-1"></a>hhsizeR <span class="op">=</span> smf.ols(<span class="st">&#39;hhsize_darfur~village&#39;</span> , data<span class="op">=</span>darfur).fit().resid</span>
<span id="cb4-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">### Auxiliary code to rearrange data</span></span>
<span id="cb4-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-15" aria-hidden="true" tabindex="-1"></a>darfurR <span class="op">=</span> pd.concat([peacefactorR, directlyharmedR, femaleR,</span>
<span id="cb4-16"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-16" aria-hidden="true" tabindex="-1"></a>                    ageR, farmerR, herderR, pastvotedR, </span>
<span id="cb4-17"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-17" aria-hidden="true" tabindex="-1"></a>                     hhsizeR, darfur[<span class="st">&#39;village&#39;</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-18"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-18" aria-hidden="true" tabindex="-1"></a>darfurR.columns <span class="op">=</span> [<span class="st">&quot;peacefactorR&quot;</span>, <span class="st">&quot;directlyharmedR&quot;</span>, <span class="st">&quot;femaleR&quot;</span>,</span>
<span id="cb4-19"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-19" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;ageR&quot;</span>, <span class="st">&quot;farmerR&quot;</span>, <span class="st">&quot;herderR&quot;</span>, <span class="st">&quot;pastvotedR&quot;</span>, </span>
<span id="cb4-20"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;hhsize_darfurR&quot;</span>, <span class="st">&quot;village&quot;</span>]</span>
<span id="cb4-21"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb4-21" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preliminary linear model analysis</span></span>
<span id="cb5-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here we are clustering standard errors at the village level</span></span>
<span id="cb5-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(peacefactorR<span class="sc">~</span> directlyharmedR<span class="sc">+</span> </span>
<span id="cb5-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb5-4" aria-hidden="true" tabindex="-1"></a>               femaleR <span class="sc">+</span> ageR <span class="sc">+</span> </span>
<span id="cb5-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb5-5" aria-hidden="true" tabindex="-1"></a>               farmerR<span class="sc">+</span> herderR <span class="sc">+</span> pastvotedR <span class="sc">+</span> </span>
<span id="cb5-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb5-6" aria-hidden="true" tabindex="-1"></a>             hhsizeR <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>village))</span></code></pre></div>
<pre><code>## 
## Call:
##    felm(formula = peacefactorR ~ directlyharmedR + femaleR + ageR +      farmerR + herderR + pastvotedR + hhsizeR | 0 | 0 | village) 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.67487 -0.14712  0.00000  0.09857  0.90307 
## 
## Coefficients:
##                   Estimate Cluster s.e. t value Pr(&gt;|t|)    
## (Intercept)     -3.681e-18    6.704e-16  -0.005  0.99562    
## directlyharmedR  9.732e-02    2.382e-02   4.085 4.68e-05 ***
## femaleR         -2.321e-01    2.444e-02  -9.495  &lt; 2e-16 ***
## ageR            -2.072e-03    7.441e-04  -2.784  0.00545 ** 
## farmerR         -4.044e-02    2.956e-02  -1.368  0.17156    
## herderR          1.428e-02    3.650e-02   0.391  0.69569    
## pastvotedR      -4.802e-02    2.688e-02  -1.787  0.07420 .  
## hhsizeR          1.230e-03    2.166e-03   0.568  0.57034    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2437 on 1268 degrees of freedom
## Multiple R-squared(full model): 0.1542   Adjusted R-squared: 0.1496 
## Multiple R-squared(proj model): 0.1542   Adjusted R-squared: 0.1496 
## F-statistic(full model, *iid*):33.03 on 7 and 1268 DF, p-value: &lt; 2.2e-16 
## F-statistic(proj model): 25.44 on 7 and 485 DF, p-value: &lt; 2.2e-16</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preliminary linear model analysis</span></span>
<span id="cb7-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here we are clustering standard errors at the village level</span></span>
<span id="cb7-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb7-3" aria-hidden="true" tabindex="-1"></a>linear_model_1 <span class="op">=</span> smf.ols(<span class="st">&#39;peacefactorR~ directlyharmedR+ femaleR + ageR + farmerR+ herderR + pastvotedR + hhsizeR&#39;</span> </span>
<span id="cb7-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb7-4" aria-hidden="true" tabindex="-1"></a>        ,data<span class="op">=</span>darfurR ).fit().get_robustcov_results(cov_type <span class="op">=</span> <span class="st">&quot;cluster&quot;</span>, groups<span class="op">=</span> darfurR[<span class="st">&#39;village&#39;</span>])</span>
<span id="cb7-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb7-5" aria-hidden="true" tabindex="-1"></a>linear_model_1_table <span class="op">=</span> linear_model_1.summary2().tables[<span class="dv">1</span>]</span>
<span id="cb7-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb7-6" aria-hidden="true" tabindex="-1"></a>linear_model_1_table</span></code></pre></div>
<pre><code>##                         Coef.      Std.Err.  ...        [0.025        0.975]
## Intercept       -2.003606e-15  8.016956e-16  ... -3.578831e-15 -4.283801e-16
## directlyharmedR  9.731582e-02  2.382281e-02  ...  5.050716e-02  1.441245e-01
## femaleR         -2.320514e-01  2.443857e-02  ... -2.800700e-01 -1.840329e-01
## ageR            -2.071749e-03  7.441260e-04  ... -3.533858e-03 -6.096402e-04
## farmerR         -4.044295e-02  2.956411e-02  ... -9.853250e-02  1.764661e-02
## herderR          1.427910e-02  3.649802e-02  ... -5.743466e-02  8.599286e-02
## pastvotedR      -4.802496e-02  2.687661e-02  ... -1.008339e-01  4.784016e-03
## hhsizeR          1.229812e-03  2.166312e-03  ... -3.026704e-03  5.486328e-03
## 
## [8 rows x 6 columns]</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here we are clustering standard errors at the village level</span></span>
<span id="cb9-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(peacefactorR<span class="sc">~</span> femaleR <span class="sc">+</span></span>
<span id="cb9-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb9-4" aria-hidden="true" tabindex="-1"></a>              ageR <span class="sc">+</span> farmerR<span class="sc">+</span> herderR <span class="sc">+</span> </span>
<span id="cb9-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb9-5" aria-hidden="true" tabindex="-1"></a>             pastvotedR <span class="sc">+</span> hhsizeR <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>village))</span></code></pre></div>
<pre><code>## 
## Call:
##    felm(formula = peacefactorR ~ femaleR + ageR + farmerR + herderR +      pastvotedR + hhsizeR | 0 | 0 | village) 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63765 -0.15168  0.00000  0.09859  0.90298 
## 
## Coefficients:
##               Estimate Cluster s.e. t value Pr(&gt;|t|)    
## (Intercept) -2.635e-18    6.584e-16  -0.004  0.99681    
## femaleR     -2.415e-01    2.536e-02  -9.522  &lt; 2e-16 ***
## ageR        -2.187e-03    7.453e-04  -2.934  0.00341 ** 
## farmerR     -4.071e-02    2.923e-02  -1.393  0.16390    
## herderR      2.623e-02    3.968e-02   0.661  0.50871    
## pastvotedR  -4.414e-02    2.784e-02  -1.585  0.11313    
## hhsizeR      1.336e-03    2.127e-03   0.628  0.52991    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2463 on 1269 degrees of freedom
## Multiple R-squared(full model): 0.1353   Adjusted R-squared: 0.1312 
## Multiple R-squared(proj model): 0.1353   Adjusted R-squared: 0.1312 
## F-statistic(full model, *iid*): 33.1 on 6 and 1269 DF, p-value: &lt; 2.2e-16 
## F-statistic(proj model): 23.07 on 6 and 485 DF, p-value: &lt; 2.2e-16</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear model 2 </span></span>
<span id="cb11-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb11-2" aria-hidden="true" tabindex="-1"></a>linear_model_2 <span class="op">=</span> smf.ols(<span class="st">&#39;peacefactorR~ femaleR + ageR + farmerR+ herderR + pastvotedR + hhsizeR&#39;</span> </span>
<span id="cb11-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb11-3" aria-hidden="true" tabindex="-1"></a>        ,data<span class="op">=</span>darfurR ).fit().get_robustcov_results(cov_type <span class="op">=</span> <span class="st">&quot;cluster&quot;</span>, groups<span class="op">=</span> darfurR[<span class="st">&#39;village&#39;</span>])</span>
<span id="cb11-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb11-4" aria-hidden="true" tabindex="-1"></a>linear_model_2_table <span class="op">=</span> linear_model_2.summary2().tables[<span class="dv">1</span>]</span>
<span id="cb11-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb11-5" aria-hidden="true" tabindex="-1"></a>linear_model_2_table</span></code></pre></div>
<pre><code>##                    Coef.      Std.Err.  ...        [0.025        0.975]
## Intercept  -1.946360e-15  7.328661e-16  ... -3.386344e-15 -5.063751e-16
## femaleR    -2.415042e-01  2.536306e-02  ... -2.913393e-01 -1.916692e-01
## ageR       -2.186810e-03  7.453429e-04  ... -3.651310e-03 -7.223106e-04
## farmerR    -4.071431e-02  2.923021e-02  ... -9.814780e-02  1.671917e-02
## herderR     2.622875e-02  3.967810e-02  ... -5.173345e-02  1.041909e-01
## pastvotedR -4.414131e-02  2.784297e-02  ... -9.884904e-02  1.056643e-02
## hhsizeR     1.336220e-03  2.126678e-03  ... -2.842419e-03  5.514859e-03
## 
## [7 rows x 6 columns]</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here we are clustering standard errors at the village level</span></span>
<span id="cb13-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">felm</span>(directlyharmedR<span class="sc">~</span> femaleR <span class="sc">+</span></span>
<span id="cb13-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb13-4" aria-hidden="true" tabindex="-1"></a>                     ageR <span class="sc">+</span> farmerR<span class="sc">+</span> herderR <span class="sc">+</span> </span>
<span id="cb13-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb13-5" aria-hidden="true" tabindex="-1"></a>             pastvotedR <span class="sc">+</span> hhsizeR <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>village))</span></code></pre></div>
<pre><code>## 
## Call:
##    felm(formula = directlyharmedR ~ femaleR + ageR + farmerR + herderR +      pastvotedR + hhsizeR | 0 | 0 | village) 
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8285 -0.3129  0.0000  0.2630  0.9076 
## 
## Coefficients:
##               Estimate Cluster s.e. t value Pr(&gt;|t|)  
## (Intercept)  1.075e-17    5.196e-16   0.021   0.9835  
## femaleR     -9.714e-02    5.129e-02  -1.894   0.0585 .
## ageR        -1.182e-03    1.151e-03  -1.028   0.3044  
## farmerR     -2.789e-03    4.280e-02  -0.065   0.9481  
## herderR      1.228e-01    5.064e-02   2.425   0.0155 *
## pastvotedR   3.991e-02    3.366e-02   1.186   0.2360  
## hhsizeR      1.093e-03    3.286e-03   0.333   0.7394  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3744 on 1269 degrees of freedom
## Multiple R-squared(full model): 0.0179   Adjusted R-squared: 0.01326 
## Multiple R-squared(proj model): 0.0179   Adjusted R-squared: 0.01326 
## F-statistic(full model, *iid*):3.856 on 6 and 1269 DF, p-value: 0.0008089 
## F-statistic(proj model): 3.828 on 6 and 485 DF, p-value: 0.0009698</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear model 3</span></span>
<span id="cb15-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb15-2" aria-hidden="true" tabindex="-1"></a>linear_model_3 <span class="op">=</span> smf.ols(<span class="st">&#39;directlyharmedR~ femaleR + ageR + farmerR+ herderR + pastvotedR + hhsizeR&#39;</span> </span>
<span id="cb15-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb15-3" aria-hidden="true" tabindex="-1"></a>        ,data<span class="op">=</span>darfurR ).fit().get_robustcov_results(cov_type <span class="op">=</span> <span class="st">&quot;cluster&quot;</span>, groups<span class="op">=</span> darfurR[<span class="st">&#39;village&#39;</span>])</span>
<span id="cb15-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb15-4" aria-hidden="true" tabindex="-1"></a>linear_model_3_table <span class="op">=</span> linear_model_3.summary2().tables[<span class="dv">1</span>]</span>
<span id="cb15-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb15-5" aria-hidden="true" tabindex="-1"></a>linear_model_3_table</span></code></pre></div>
<pre><code>##                    Coef.      Std.Err.  ...        [0.025        0.975]
## Intercept   5.867702e-16  7.973710e-16  ... -9.799580e-16  2.153498e-15
## femaleR    -9.713517e-02  5.128637e-02  ... -1.979061e-01  3.635740e-03
## ageR       -1.182350e-03  1.150680e-03  ... -3.443283e-03  1.078584e-03
## farmerR    -2.788538e-03  4.280159e-02  ... -8.688797e-02  8.131090e-02
## herderR     1.227925e-01  5.064352e-02  ...  2.328466e-02  2.223002e-01
## pastvotedR  3.990773e-02  3.366253e-02  ... -2.623468e-02  1.060501e-01
## hhsizeR     1.093431e-03  3.286160e-03  ... -5.363437e-03  7.550298e-03
## 
## [7 rows x 6 columns]</code></pre>
</div>
</div>
</div>
<div id="we-first-use-lasso-for-partilling-out-controls" class="section level2" number="19.4">
<h2><span class="header-section-number">19.4</span> We first use Lasso for Partilling Out Controls</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hdm)</span>
<span id="cb17-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-3" aria-hidden="true" tabindex="-1"></a>resY <span class="ot">=</span>  <span class="fu">rlasso</span>(peacefactorR <span class="sc">~</span>  (femaleR <span class="sc">+</span></span>
<span id="cb17-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-4" aria-hidden="true" tabindex="-1"></a>                        ageR <span class="sc">+</span> </span>
<span id="cb17-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-5" aria-hidden="true" tabindex="-1"></a>                        farmerR<span class="sc">+</span> </span>
<span id="cb17-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-6" aria-hidden="true" tabindex="-1"></a>                        herderR <span class="sc">+</span> </span>
<span id="cb17-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-7" aria-hidden="true" tabindex="-1"></a>                        pastvotedR <span class="sc">+</span> </span>
<span id="cb17-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-8" aria-hidden="true" tabindex="-1"></a>                        hhsizeR)<span class="sc">^</span><span class="dv">3</span>, <span class="at">post=</span>F)<span class="sc">$</span>res</span>
<span id="cb17-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-10" aria-hidden="true" tabindex="-1"></a>resD <span class="ot">=</span>  <span class="fu">rlasso</span>(directlyharmedR <span class="sc">~</span>  (femaleR <span class="sc">+</span></span>
<span id="cb17-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-11" aria-hidden="true" tabindex="-1"></a>                        ageR <span class="sc">+</span> </span>
<span id="cb17-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-12" aria-hidden="true" tabindex="-1"></a>                        farmerR <span class="sc">+</span> </span>
<span id="cb17-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-13" aria-hidden="true" tabindex="-1"></a>                        herderR <span class="sc">+</span> </span>
<span id="cb17-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-14" aria-hidden="true" tabindex="-1"></a>                        pastvotedR <span class="sc">+</span> </span>
<span id="cb17-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb17-15" aria-hidden="true" tabindex="-1"></a>                        hhsizeR)<span class="sc">^</span><span class="dv">3</span> , <span class="at">post=</span>F)<span class="sc">$</span>res</span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> hdmpy</span>
<span id="cb18-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> patsy </span>
<span id="cb18-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> patsy <span class="im">import</span> ModelDesc, Term, EvalFactor</span>
<span id="cb18-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> patsy.dmatrix(<span class="st">&quot;(femaleR + ageR + farmerR+ herderR + pastvotedR + hhsizeR)**3&quot;</span>, darfurR)</span>
<span id="cb18-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-6" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> darfurR[<span class="st">&#39;peacefactorR&#39;</span>].to_numpy()</span>
<span id="cb18-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-7" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> darfurR[<span class="st">&#39;directlyharmedR&#39;</span>].to_numpy()</span>
<span id="cb18-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-9" aria-hidden="true" tabindex="-1"></a>resY <span class="op">=</span> hdmpy.rlasso(X[: , <span class="dv">1</span>:],Y, post <span class="op">=</span> <span class="va">False</span>).est[<span class="st">&#39;residuals&#39;</span>].reshape( Y.size,)</span>
<span id="cb18-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-10" aria-hidden="true" tabindex="-1"></a>resD <span class="op">=</span> hdmpy.rlasso(X[: , <span class="dv">1</span>:],D, post <span class="op">=</span> <span class="va">False</span>).est[<span class="st">&#39;residuals&#39;</span>].reshape( D.size,)</span>
<span id="cb18-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-11" aria-hidden="true" tabindex="-1"></a>FVU_Y <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.var(resY)<span class="op">/</span>np.var(peacefactorR)</span>
<span id="cb18-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb18-12" aria-hidden="true" tabindex="-1"></a>FVU_D <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.var(resD)<span class="op">/</span>np.var(directlyharmedR)</span></code></pre></div>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( <span class="fu">rlasso</span>(peacefactorR <span class="sc">~</span>  (femaleR <span class="sc">+</span></span>
<span id="cb19-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                     ageR <span class="sc">+</span> </span>
<span id="cb19-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-3" aria-hidden="true" tabindex="-1"></a>                     farmerR<span class="sc">+</span> </span>
<span id="cb19-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-4" aria-hidden="true" tabindex="-1"></a>                     herderR <span class="sc">+</span> </span>
<span id="cb19-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-5" aria-hidden="true" tabindex="-1"></a>                     pastvotedR <span class="sc">+</span> </span>
<span id="cb19-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-6" aria-hidden="true" tabindex="-1"></a>                     hhsizeR)<span class="sc">^</span><span class="dv">3</span>, </span>
<span id="cb19-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb19-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">post=</span>F) )</span></code></pre></div>
<pre><code>## 
## Call:
## rlasso.formula(formula = peacefactorR ~ (femaleR + ageR + farmerR + 
##     herderR + pastvotedR + hhsizeR)^3, post = F)
## 
## Post-Lasso Estimation:  FALSE 
## 
## Total number of variables: 41
## Number of selected variables: 5 
## 
## Residuals: 
##        Min         1Q     Median         3Q        Max 
## -0.6045408 -0.1552131  0.0005935  0.0899936  0.8968939 
## 
##                            Estimate
## (Intercept)                  -0.001
## femaleR                      -0.201
## ageR                          0.000
## farmerR                      -0.004
## herderR                       0.000
## pastvotedR                    0.000
## hhsizeR                       0.000
## femaleR:ageR                  0.000
## femaleR:farmerR               0.000
## femaleR:herderR               0.000
## femaleR:pastvotedR            0.026
## femaleR:hhsizeR               0.000
## ageR:farmerR                  0.000
## ageR:herderR                  0.000
## ageR:pastvotedR               0.000
## ageR:hhsizeR                  0.000
## farmerR:herderR               0.000
## farmerR:pastvotedR            0.000
## farmerR:hhsizeR               0.000
## herderR:pastvotedR            0.000
## herderR:hhsizeR               0.000
## pastvotedR:hhsizeR            0.000
## femaleR:ageR:farmerR          0.000
## femaleR:ageR:herderR          0.000
## femaleR:ageR:pastvotedR       0.000
## femaleR:ageR:hhsizeR          0.000
## femaleR:farmerR:herderR       0.000
## femaleR:farmerR:pastvotedR    0.000
## femaleR:farmerR:hhsizeR       0.000
## femaleR:herderR:pastvotedR    0.000
## femaleR:herderR:hhsizeR       0.000
## femaleR:pastvotedR:hhsizeR    0.000
## ageR:farmerR:herderR          0.000
## ageR:farmerR:pastvotedR       0.002
## ageR:farmerR:hhsizeR          0.000
## ageR:herderR:pastvotedR       0.000
## ageR:herderR:hhsizeR          0.000
## ageR:pastvotedR:hhsizeR       0.000
## farmerR:herderR:pastvotedR    0.000
## farmerR:herderR:hhsizeR       0.000
## farmerR:pastvotedR:hhsizeR    0.000
## herderR:pastvotedR:hhsizeR    0.000
## 
## Residual standard error: 0.2472
## Multiple R-squared:  0.1251
## Adjusted R-squared:  0.1217
## Joint significance test:
##  the sup score statistic for joint significance test is 16.89 with a p-value of 0.626</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-1" aria-hidden="true" tabindex="-1"></a>rlasso_1 <span class="op">=</span> hdmpy.rlasso(X[: , <span class="dv">1</span>:],Y, post <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb21-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> summary_rlasso( mod , X1):</span>
<span id="cb21-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-4" aria-hidden="true" tabindex="-1"></a>    ob1 <span class="op">=</span> mod.est[<span class="st">&#39;coefficients&#39;</span>].rename(columns <span class="op">=</span> { <span class="dv">0</span> : <span class="st">&quot;Est.&quot;</span>})</span>
<span id="cb21-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-5" aria-hidden="true" tabindex="-1"></a>    ob1.index <span class="op">=</span> X1.design_info.column_names</span>
<span id="cb21-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ob1</span>
<span id="cb21-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb21-8" aria-hidden="true" tabindex="-1"></a>summary_rlasso(rlasso_1 , X)</span></code></pre></div>
<pre><code>##                                 Est.
## Intercept                  -0.000593
## femaleR                    -0.200735
## ageR                       -0.000381
## farmerR                    -0.004220
## herderR                     0.000000
## pastvotedR                  0.000000
## hhsizeR                     0.000000
## femaleR:ageR                0.000000
## femaleR:farmerR             0.000000
## femaleR:herderR             0.000000
## femaleR:pastvotedR          0.025755
## femaleR:hhsizeR             0.000000
## ageR:farmerR                0.000000
## ageR:herderR                0.000000
## ageR:pastvotedR             0.000000
## ageR:hhsizeR                0.000000
## farmerR:herderR             0.000000
## farmerR:pastvotedR          0.000000
## farmerR:hhsizeR             0.000000
## herderR:pastvotedR          0.000000
## herderR:hhsizeR             0.000000
## pastvotedR:hhsizeR          0.000000
## femaleR:ageR:farmerR        0.000000
## femaleR:ageR:herderR        0.000000
## femaleR:ageR:pastvotedR     0.000000
## femaleR:ageR:hhsizeR        0.000000
## femaleR:farmerR:herderR     0.000000
## femaleR:farmerR:pastvotedR  0.000000
## femaleR:farmerR:hhsizeR     0.000000
## femaleR:herderR:pastvotedR  0.000000
## femaleR:herderR:hhsizeR     0.000000
## femaleR:pastvotedR:hhsizeR  0.000000
## ageR:farmerR:herderR        0.000000
## ageR:farmerR:pastvotedR     0.001897
## ageR:farmerR:hhsizeR        0.000000
## ageR:herderR:pastvotedR     0.000000
## ageR:herderR:hhsizeR        0.000000
## ageR:pastvotedR:hhsizeR     0.000000
## farmerR:herderR:pastvotedR  0.000000
## farmerR:herderR:hhsizeR     0.000000
## farmerR:pastvotedR:hhsizeR  0.000000
## herderR:pastvotedR:hhsizeR  0.000000</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&quot;Controls explain the following fraction of variance of Outcome&quot;</span>, <span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(resY)<span class="sc">/</span><span class="fu">var</span>(peacefactorR)))</span></code></pre></div>
<pre><code>## [1] &quot;Controls explain the following fraction of variance of Outcome&quot;
## [2] &quot;0.125108054898996&quot;</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Controls explain the following fraction of variance of Outcome&quot;</span>, FVU_Y)</span></code></pre></div>
<pre><code>## Controls explain the following fraction of variance of Outcome 0.12510805781802825</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&quot;Controls explain the following fraction of variance of Treatment&quot;</span>, <span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(resD)<span class="sc">/</span><span class="fu">var</span>(directlyharmedR)))</span></code></pre></div>
<pre><code>## [1] &quot;Controls explain the following fraction of variance of Treatment&quot;
## [2] &quot;0.0119842379295229&quot;</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Controls explain the following fraction of variance of treatment&quot;</span>, FVU_D)</span></code></pre></div>
<pre><code>## Controls explain the following fraction of variance of treatment 0.011984223484257428</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lfe)</span>
<span id="cb31-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb31-3" aria-hidden="true" tabindex="-1"></a>dml.darfur.model<span class="ot">=</span> <span class="fu">felm</span>(resY <span class="sc">~</span> resD<span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>village)   <span class="co"># cluster SEs by village</span></span>
<span id="cb31-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dml.darfur.model,</span>
<span id="cb31-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">robust=</span>T)  <span class="co">#culster SE by village</span></span></code></pre></div>
<pre><code>## 
## Call:
##    felm(formula = resY ~ resD | 0 | 0 | village) 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63410 -0.15299  0.00069  0.09305  0.89593 
## 
## Coefficients:
##               Estimate Cluster s.e. t value Pr(&gt;|t|)    
## (Intercept) -1.250e-18    1.594e-04   0.000        1    
## resD         1.003e-01    2.443e-02   4.108 4.25e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2444 on 1274 degrees of freedom
## Multiple R-squared(full model): 0.02312   Adjusted R-squared: 0.02235 
## Multiple R-squared(proj model): 0.02312   Adjusted R-squared: 0.02235 
## F-statistic(full model, *iid*):30.15 on 1 and 1274 DF, p-value: 4.82e-08 
## F-statistic(proj model): 16.87 on 1 and 485 DF, p-value: 4.693e-05</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filan estimation</span></span>
<span id="cb33-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-2" aria-hidden="true" tabindex="-1"></a>darfurR[<span class="st">&#39;resY&#39;</span>] <span class="op">=</span> resY</span>
<span id="cb33-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-3" aria-hidden="true" tabindex="-1"></a>darfurR[<span class="st">&#39;resD&#39;</span>] <span class="op">=</span> resD</span>
<span id="cb33-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Culster SE by village</span></span>
<span id="cb33-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-5" aria-hidden="true" tabindex="-1"></a>dml_darfur_model <span class="op">=</span> smf.ols(<span class="st">&#39;resY~ resD&#39;</span>,data<span class="op">=</span>darfurR ).fit().get_robustcov_results(cov_type <span class="op">=</span> <span class="st">&quot;cluster&quot;</span>, groups<span class="op">=</span> darfurR[<span class="st">&#39;village&#39;</span>])</span>
<span id="cb33-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-6" aria-hidden="true" tabindex="-1"></a>dml_darfur_model_table <span class="op">=</span> dml_darfur_model.summary2().tables[<span class="dv">1</span>]</span>
<span id="cb33-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb33-7" aria-hidden="true" tabindex="-1"></a>dml_darfur_model_table</span></code></pre></div>
<pre><code>##                   Coef.  Std.Err.         t     P&gt;|t|    [0.025    0.975]
## Intercept -6.372846e-10  0.000159 -0.000004  0.999997 -0.000313  0.000313
## resD       1.003364e-01  0.024427  4.107546  0.000047  0.052340  0.148333</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb35-1" aria-hidden="true" tabindex="-1"></a>dml.darfur.model<span class="ot">=</span> <span class="fu">lm</span>(resY <span class="sc">~</span> resD)  <span class="co">#lineaer model to use as input in sensemakr   </span></span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model to use as input in sensemakr   </span></span>
<span id="cb36-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb36-2" aria-hidden="true" tabindex="-1"></a>dml_darfur_model<span class="op">=</span> smf.ols(<span class="st">&#39;resY~ resD&#39;</span>,data<span class="op">=</span>darfurR ).fit()</span>
<span id="cb36-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb36-3" aria-hidden="true" tabindex="-1"></a>dml_darfur_model_table <span class="op">=</span> dml_darfur_model.summary2().tables[<span class="dv">1</span>]</span></code></pre></div>
</div>
</div>
</div>
<div id="manual-bias-analysis" class="section level2" number="19.5">
<h2><span class="header-section-number">19.5</span> Manual Bias Analysis</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main estimate</span></span>
<span id="cb37-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> dml.darfur.model<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb37-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical values of partial R2s </span></span>
<span id="cb37-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-5" aria-hidden="true" tabindex="-1"></a>R2.YC <span class="ot">=</span> .<span class="dv">16</span>; R2.DC <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb37-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Elements of the formal</span></span>
<span id="cb37-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-8" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">&lt;-</span>  (R2.YC <span class="sc">*</span> R2.DC)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span> R2.DC)</span>
<span id="cb37-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-9" aria-hidden="true" tabindex="-1"></a>varianceRatio<span class="ot">&lt;-</span> <span class="fu">mean</span>(dml.darfur.model<span class="sc">$</span>res<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">mean</span>(dml.darfur.model<span class="sc">$</span>res<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute square bias </span></span>
<span id="cb37-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-12" aria-hidden="true" tabindex="-1"></a>BiasSq <span class="ot">&lt;-</span>  kappa<span class="sc">*</span>varianceRatio</span>
<span id="cb37-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute absolute value of the bias</span></span>
<span id="cb37-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sqrt</span>(BiasSq))</span></code></pre></div>
<pre><code>## [1] 0.04020151</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-2" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> dml_darfur_model_table[<span class="st">&#39;Coef.&#39;</span>][<span class="dv">1</span>]</span>
<span id="cb39-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical values of partial R2s </span></span>
<span id="cb39-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-5" aria-hidden="true" tabindex="-1"></a>R2_YC <span class="op">=</span> <span class="fl">.16</span> </span>
<span id="cb39-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-6" aria-hidden="true" tabindex="-1"></a>R2_DC <span class="op">=</span> <span class="fl">.01</span></span>
<span id="cb39-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Elements of the formal</span></span>
<span id="cb39-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-9" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> (R2_YC <span class="op">*</span> R2_DC)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span> R2_DC)</span>
<span id="cb39-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-10" aria-hidden="true" tabindex="-1"></a>varianceRatio <span class="op">=</span> np.mean(dml_darfur_model.resid<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>np.mean(dml_darfur_model.resid<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb39-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute square bias </span></span>
<span id="cb39-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-13" aria-hidden="true" tabindex="-1"></a>BiasSq <span class="op">=</span>  kappa<span class="op">*</span>varianceRatio</span>
<span id="cb39-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute absolute value of the bias</span></span>
<span id="cb39-16"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.sqrt(BiasSq))</span></code></pre></div>
<pre><code>## 0.04020151261036848</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting </span></span>
<span id="cb41-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-2" aria-hidden="true" tabindex="-1"></a>gridR2.DC<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,.<span class="dv">3</span>, <span class="at">by=</span>.<span class="dv">001</span>) </span>
<span id="cb41-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-3" aria-hidden="true" tabindex="-1"></a>gridR2.YC<span class="ot">&lt;-</span> kappa<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> gridR2.DC)<span class="sc">/</span>gridR2.DC</span>
<span id="cb41-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-4" aria-hidden="true" tabindex="-1"></a>gridR2.YC<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gridR2.YC<span class="sc">&gt;</span> <span class="dv">1</span>, <span class="dv">1</span>, gridR2.YC);</span>
<span id="cb41-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gridR2.DC, </span>
<span id="cb41-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-7" aria-hidden="true" tabindex="-1"></a>     gridR2.YC, </span>
<span id="cb41-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="dv">4</span>, </span>
<span id="cb41-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Partial R2 of Treatment with Confounder&quot;</span>, </span>
<span id="cb41-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Partial R2 of Outcome with Confounder&quot;</span>,</span>
<span id="cb41-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span> <span class="fu">c</span>(<span class="st">&quot;Combo of R2 such that |Bias|&lt; &quot;</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(BiasSq), <span class="at">digits=</span><span class="dv">4</span>))</span>
<span id="cb41-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb41-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting </span></span>
<span id="cb42-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb42-2" aria-hidden="true" tabindex="-1"></a>gridR2_DC <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="fl">0.3</span>,<span class="fl">0.001</span>)</span>
<span id="cb42-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb42-3" aria-hidden="true" tabindex="-1"></a>gridR2_YC <span class="op">=</span>  kappa<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span> gridR2_DC)<span class="op">/</span>gridR2_DC</span>
<span id="cb42-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb42-4" aria-hidden="true" tabindex="-1"></a>gridR2_YC <span class="op">=</span> np.where(gridR2_YC <span class="op">&gt;</span> <span class="dv">1</span>, <span class="dv">1</span>, gridR2_YC)</span>
<span id="cb42-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Combo of R2 such that |Bias|&lt;</span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(<span class="bu">round</span>(np.sqrt(BiasSq), <span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## Text(0.5, 1.0, &#39;Combo of R2 such that |Bias|&lt;0.0402&#39;)</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb44-1" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Partial R2 of Treatment with Confounder&quot;</span>) </span></code></pre></div>
<pre><code>## Text(0.5, 0, &#39;Partial R2 of Treatment with Confounder&#39;)</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb46-1" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Partial R2 of Outcome with Confounder&quot;</span>) </span></code></pre></div>
<pre><code>## Text(0, 0.5, &#39;Partial R2 of Outcome with Confounder&#39;)</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb48-1" aria-hidden="true" tabindex="-1"></a>plt.plot(gridR2_DC,gridR2_YC) </span></code></pre></div>
<pre><code>## [&lt;matplotlib.lines.Line2D object at 0x000000004ABF09A0&gt;]</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb50-1" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="bias-analysis-with-sensemakr" class="section level2" number="19.6">
<h2><span class="header-section-number">19.6</span> Bias Analysis with Sensemakr</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb51-1" aria-hidden="true" tabindex="-1"></a>dml.darfur.sensitivity <span class="ot">&lt;-</span> <span class="fu">sensemakr</span>(<span class="at">model =</span> dml.darfur.model, </span>
<span id="cb51-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb51-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">treatment =</span> <span class="st">&quot;resD&quot;</span>)</span>
<span id="cb51-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dml.darfur.sensitivity)</span></code></pre></div>
<pre><code>## Sensitivity Analysis to Unobserved Confounding
## 
## Model Formula: resY ~ resD
## 
## Null hypothesis: q = 1 and reduce = TRUE 
## -- This means we are considering biases that reduce the absolute value of the current estimate.
## -- The null hypothesis deemed problematic is H0:tau = 0 
## 
## Unadjusted Estimates of &#39;resD&#39;: 
##   Coef. estimate: 0.1003 
##   Standard Error: 0.0183 
##   t-value (H0:tau = 0): 5.491 
## 
## Sensitivity Statistics:
##   Partial R2 of treatment with outcome: 0.0231 
##   Robustness Value, q = 1: 0.1425 
##   Robustness Value, q = 1, alpha = 0.05: 0.0941 
## 
## Verbal interpretation of sensitivity statistics:
## 
## -- Partial R2 of the treatment with the outcome: an extreme confounder (orthogonal to the covariates) that explains 100% of the residual variance of the outcome, would need to explain at least 2.31% of the residual variance of the treatment to fully account for the observed estimated effect.
## 
## -- Robustness Value, q = 1: unobserved confounders (orthogonal to the covariates) that explain more than 14.25% of the residual variance of both the treatment and the outcome are strong enough to bring the point estimate to 0 (a bias of 100% of the original estimate). Conversely, unobserved confounders that do not explain more than 14.25% of the residual variance of both the treatment and the outcome are not strong enough to bring the point estimate to 0.
## 
## -- Robustness Value, q = 1, alpha = 0.05: unobserved confounders (orthogonal to the covariates) that explain more than 9.41% of the residual variance of both the treatment and the outcome are strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0 (a bias of 100% of the original estimate), at the significance level of alpha = 0.05. Conversely, unobserved confounders that do not explain more than 9.41% of the residual variance of both the treatment and the outcome are not strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0, at the significance level of alpha = 0.05.</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports</span></span>
<span id="cb53-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> sensemakr</span>
<span id="cb53-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> sensitivity_stats</span>
<span id="cb53-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> bias_functions</span>
<span id="cb53-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> ovb_bounds</span>
<span id="cb53-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sensemakr <span class="im">import</span> ovb_plots</span>
<span id="cb53-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb53-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb53-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to double check why the function does not allow to run withour the benchmark_covariates argument</span></span>
<span id="cb53-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-12" aria-hidden="true" tabindex="-1"></a>dml_darfur_sensitivity <span class="op">=</span> sensemakr.Sensemakr(dml_darfur_model, <span class="st">&quot;resD&quot;</span>, benchmark_covariates <span class="op">=</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb53-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb53-13" aria-hidden="true" tabindex="-1"></a>ovb_plots.extract_from_sense_obj( dml_darfur_sensitivity )</span></code></pre></div>
<pre><code>## (&#39;resD&#39;, 0.10033644720396692, 0.018272934212004013, 1274.0, 0    2.166013e-18
## Name: r2dz_x, dtype: float64, 0    6.808156e-18
## Name: r2yz_dx, dtype: float64, 0    1x Intercept
## Name: bound_label, dtype: object, True, 0.0, 1.9618292555617416)</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a contour plot for the estimate</span></span>
<span id="cb55-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dml.darfur.sensitivity, <span class="at">nlevels =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a contour plot for the estimate</span></span>
<span id="cb56-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb56-2" aria-hidden="true" tabindex="-1"></a>ovb_plots.ovb_contour_plot(sense_obj<span class="op">=</span>dml_darfur_sensitivity, sensitivity_of<span class="op">=</span><span class="st">&#39;estimate&#39;</span>)</span>
<span id="cb56-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb56-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="576" /></p>
</div>
</div>
</div>
<div id="next-we-use-random-forest-as-ml-tool-for-partialling-out" class="section level2" number="19.7">
<h2><span class="header-section-number">19.7</span> Next We use Random Forest as ML tool for Partialling Out</h2>
<p>The following code does DML with clsutered standard errors by ClusterID</p>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-1" aria-hidden="true" tabindex="-1"></a>DML2.for.PLM <span class="ot">&lt;-</span> <span class="cf">function</span>(x, d, y, dreg, yreg, <span class="at">nfold=</span><span class="dv">2</span>, clusterID) {</span>
<span id="cb57-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x) <span class="co">#number of observations</span></span>
<span id="cb57-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  foldid <span class="ot">&lt;-</span> <span class="fu">rep.int</span>(<span class="dv">1</span><span class="sc">:</span>nfold,<span class="at">times =</span> <span class="fu">ceiling</span>(nobs<span class="sc">/</span>nfold))[<span class="fu">sample.int</span>(nobs)] <span class="co">#define folds indices</span></span>
<span id="cb57-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="dv">1</span><span class="sc">:</span>nobs, foldid)  <span class="co">#split observation indices into folds  </span></span>
<span id="cb57-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-8" aria-hidden="true" tabindex="-1"></a>  ytil <span class="ot">&lt;-</span> dtil <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nobs)</span>
<span id="cb57-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;fold: &quot;</span>)</span>
<span id="cb57-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(I)){</span>
<span id="cb57-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-14" aria-hidden="true" tabindex="-1"></a>    dfit <span class="ot">&lt;-</span> <span class="fu">dreg</span>(x[<span class="sc">-</span>I[[b]],], d[<span class="sc">-</span>I[[b]]]) <span class="co">#take a fold out</span></span>
<span id="cb57-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-16"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-16" aria-hidden="true" tabindex="-1"></a>    yfit <span class="ot">&lt;-</span> <span class="fu">yreg</span>(x[<span class="sc">-</span>I[[b]],], y[<span class="sc">-</span>I[[b]]]) <span class="co"># take a foldt out</span></span>
<span id="cb57-17"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-18"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-18" aria-hidden="true" tabindex="-1"></a>    dhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(dfit, x[I[[b]],], <span class="at">type=</span><span class="st">&quot;response&quot;</span>) <span class="co">#predict the left-out fold </span></span>
<span id="cb57-19"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-20"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-20" aria-hidden="true" tabindex="-1"></a>    yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(yfit, x[I[[b]],], <span class="at">type=</span><span class="st">&quot;response&quot;</span>) <span class="co">#predict the left-out fold </span></span>
<span id="cb57-21"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-22"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-22" aria-hidden="true" tabindex="-1"></a>    dtil[I[[b]]] <span class="ot">&lt;-</span> (d[I[[b]]] <span class="sc">-</span> dhat) <span class="co">#record residual for the left-out fold</span></span>
<span id="cb57-23"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-24"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-24" aria-hidden="true" tabindex="-1"></a>    ytil[I[[b]]] <span class="ot">&lt;-</span> (y[I[[b]]] <span class="sc">-</span> yhat) <span class="co">#record residial for the left-out fold</span></span>
<span id="cb57-25"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-26"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(b,<span class="st">&quot; &quot;</span>)</span>
<span id="cb57-27"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb57-28"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-28" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb57-29"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-30"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-30" aria-hidden="true" tabindex="-1"></a>  rfit <span class="ot">&lt;-</span> <span class="fu">felm</span>(ytil <span class="sc">~</span> dtil <span class="sc">|</span><span class="dv">0</span><span class="sc">|</span><span class="dv">0</span><span class="sc">|</span>clusterID)    <span class="co">#get clustered standard errors using felm</span></span>
<span id="cb57-31"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-32"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-32" aria-hidden="true" tabindex="-1"></a>  rfitSummary<span class="ot">&lt;-</span> <span class="fu">summary</span>(rfit)</span>
<span id="cb57-33"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-34"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-34" aria-hidden="true" tabindex="-1"></a>  coef.est <span class="ot">&lt;-</span>  rfitSummary<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="co">#extract coefficient</span></span>
<span id="cb57-35"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-36"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-36" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> rfitSummary<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]  <span class="co">#record robust standard error</span></span>
<span id="cb57-37"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-38"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">coef (se) = %g (%g)</span><span class="sc">\n</span><span class="st">&quot;</span>, coef.est , se))  <span class="co">#printing output</span></span>
<span id="cb57-39"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-40"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">list</span>(<span class="at">coef.est =</span>coef.est , <span class="at">se=</span>se, <span class="at">dtil=</span>dtil, <span class="at">ytil=</span>ytil) ) <span class="co">#save output and residuals </span></span>
<span id="cb57-41"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-42"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb57-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb58-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> compress</span>
<span id="cb58-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> DML2_for_PLM(x, d, y, dreg, yreg, nfold, clu):</span>
<span id="cb58-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Num ob observations</span></span>
<span id="cb58-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-7" aria-hidden="true" tabindex="-1"></a>    nobs <span class="op">=</span> x.shape[<span class="dv">0</span>]</span>
<span id="cb58-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define folds indices </span></span>
<span id="cb58-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-10" aria-hidden="true" tabindex="-1"></a>    list_1 <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, nfold, <span class="dv">1</span>)]<span class="op">*</span>nobs</span>
<span id="cb58-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-11" aria-hidden="true" tabindex="-1"></a>    sample <span class="op">=</span> np.random.choice(nobs,nobs, replace<span class="op">=</span><span class="va">False</span>).tolist()</span>
<span id="cb58-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-12" aria-hidden="true" tabindex="-1"></a>    foldid <span class="op">=</span> [list_1[index] <span class="cf">for</span> index <span class="kw">in</span> sample]</span>
<span id="cb58-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create split function(similar to R)</span></span>
<span id="cb58-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> split(z, f):</span>
<span id="cb58-16"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-16" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">max</span>(f) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb58-17"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">tuple</span>( <span class="bu">list</span>(itertools.compress(z, (el <span class="op">==</span> i <span class="cf">for</span> el <span class="kw">in</span> f))) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(count) ) </span>
<span id="cb58-18"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split observation indices into folds </span></span>
<span id="cb58-20"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-20" aria-hidden="true" tabindex="-1"></a>    list_2 <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, nobs, <span class="dv">1</span>)]</span>
<span id="cb58-21"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-21" aria-hidden="true" tabindex="-1"></a>    I <span class="op">=</span> split(list_2, foldid)</span>
<span id="cb58-22"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-23"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop to save results</span></span>
<span id="cb58-24"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(I)):</span>
<span id="cb58-25"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-26"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Split data - index to keep are in mask as booleans</span></span>
<span id="cb58-27"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-27" aria-hidden="true" tabindex="-1"></a>        include_idx <span class="op">=</span> <span class="bu">set</span>(I[b])  <span class="co">#Here should go I[b] Set is more efficient, but doesn&#39;t reorder your elements if that is desireable</span></span>
<span id="cb58-28"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-28" aria-hidden="true" tabindex="-1"></a>        mask <span class="op">=</span> np.array([(i <span class="kw">in</span> include_idx) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x))])</span>
<span id="cb58-29"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-30"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lasso regression, excluding folds selected </span></span>
<span id="cb58-31"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-31" aria-hidden="true" tabindex="-1"></a>        dfit <span class="op">=</span> dreg(x[<span class="op">~</span>mask,], d[<span class="op">~</span>mask,])</span>
<span id="cb58-32"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-32" aria-hidden="true" tabindex="-1"></a>        yfit <span class="op">=</span> yreg(x[<span class="op">~</span>mask,], y[<span class="op">~</span>mask,])</span>
<span id="cb58-33"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-34"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># predict estimates using the </span></span>
<span id="cb58-35"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-35" aria-hidden="true" tabindex="-1"></a>        dhat <span class="op">=</span> dfit.predict( x[mask,] )</span>
<span id="cb58-36"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-36" aria-hidden="true" tabindex="-1"></a>        yhat <span class="op">=</span> yfit.predict( x[mask,] )</span>
<span id="cb58-37"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-38"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create array to save errors </span></span>
<span id="cb58-39"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-39" aria-hidden="true" tabindex="-1"></a>        dtil <span class="op">=</span> np.zeros( <span class="bu">len</span>(x) ).reshape( <span class="bu">len</span>(x) , <span class="dv">1</span> )</span>
<span id="cb58-40"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-40" aria-hidden="true" tabindex="-1"></a>        ytil <span class="op">=</span> np.zeros( <span class="bu">len</span>(x) ).reshape( <span class="bu">len</span>(x) , <span class="dv">1</span> )</span>
<span id="cb58-41"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-42"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># save errors  </span></span>
<span id="cb58-43"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-43" aria-hidden="true" tabindex="-1"></a>        dtil[mask] <span class="op">=</span>  d[mask,] <span class="op">-</span> dhat.reshape( <span class="bu">len</span>(I[b]) , <span class="dv">1</span> )</span>
<span id="cb58-44"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-44" aria-hidden="true" tabindex="-1"></a>        ytil[mask] <span class="op">=</span> y[mask,] <span class="op">-</span> yhat.reshape( <span class="bu">len</span>(I[b]) , <span class="dv">1</span> )</span>
<span id="cb58-45"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(b, <span class="st">&quot; &quot;</span>)</span>
<span id="cb58-46"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-47"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create dataframe </span></span>
<span id="cb58-48"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-48" aria-hidden="true" tabindex="-1"></a>    data_2 <span class="op">=</span> pd.DataFrame(np.concatenate( ( ytil, dtil,clu ), axis <span class="op">=</span> <span class="dv">1</span>), columns <span class="op">=</span> [<span class="st">&#39;ytil&#39;</span>,<span class="st">&#39;dtil&#39;</span>,<span class="st">&#39;CountyCode&#39;</span>])</span>
<span id="cb58-49"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-49" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb58-50"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-50" aria-hidden="true" tabindex="-1"></a>     <span class="co"># OLS clustering at the County level</span></span>
<span id="cb58-51"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-51" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> <span class="st">&quot;ytil ~ dtil&quot;</span></span>
<span id="cb58-52"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-52" aria-hidden="true" tabindex="-1"></a>    baseline_ols <span class="op">=</span> smf.ols(model , data<span class="op">=</span>data_2).fit().get_robustcov_results(cov_type <span class="op">=</span> <span class="st">&quot;cluster&quot;</span>, groups<span class="op">=</span> data_2[<span class="st">&#39;CountyCode&#39;</span>])</span>
<span id="cb58-53"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-53" aria-hidden="true" tabindex="-1"></a>    coef_est <span class="op">=</span> baseline_ols.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;Coef.&#39;</span>][<span class="st">&#39;dtil&#39;</span>]</span>
<span id="cb58-54"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-54" aria-hidden="true" tabindex="-1"></a>    se <span class="op">=</span> baseline_ols.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;Std.Err.&#39;</span>][<span class="st">&#39;dtil&#39;</span>]</span>
<span id="cb58-55"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-56"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Coefficient is </span><span class="sc">{}</span><span class="st">, SE is equal to </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(coef_est, se))</span>
<span id="cb58-57"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-58"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb58-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> coef_est, se, dtil, ytil, data_2</span></code></pre></div>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)  <span class="co">#random Forest library</span></span>
<span id="cb59-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb59-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>  femaleR <span class="sc">+</span> ageR <span class="sc">+</span> farmerR <span class="sc">+</span> herderR <span class="sc">+</span> pastvotedR <span class="sc">+</span> hhsizeR)</span>
<span id="cb59-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb59-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span> directlyharmedR</span>
<span id="cb59-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb59-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> peacefactorR;</span>
<span id="cb59-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div>
<pre><code>## [1] 1276    7</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb61-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb61-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingRegressor</span>
<span id="cb61-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb61-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This new matrix include intercept</span></span>
<span id="cb61-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> patsy.dmatrix(<span class="st">&quot;~  femaleR + ageR + farmerR + herderR + pastvotedR + hhsizeR&quot;</span>, darfurR)</span>
<span id="cb61-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> darfurR[<span class="st">&#39;peacefactorR&#39;</span>].to_numpy().reshape( <span class="bu">len</span>(Y) , <span class="dv">1</span> )</span>
<span id="cb61-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-10" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> darfurR[<span class="st">&#39;directlyharmedR&#39;</span>].to_numpy().reshape( <span class="bu">len</span>(Y) , <span class="dv">1</span> )</span>
<span id="cb61-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb61-11" aria-hidden="true" tabindex="-1"></a>x.shape</span></code></pre></div>
<pre><code>## (1276, 7)</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DML with Random Forest:</span></span>
<span id="cb63-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb63-2" aria-hidden="true" tabindex="-1"></a>dreg <span class="ot">&lt;-</span> <span class="cf">function</span>(x,d){ <span class="fu">randomForest</span>(x, d) } <span class="co">#ML method=Forest </span></span>
<span id="cb63-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb63-3" aria-hidden="true" tabindex="-1"></a>yreg <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){ <span class="fu">randomForest</span>(x, y) } <span class="co">#ML method=Forest</span></span>
<span id="cb63-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb63-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb63-5" aria-hidden="true" tabindex="-1"></a>DML2.RF <span class="ot">=</span> <span class="fu">DML2.for.PLM</span>(x, d, y, dreg, yreg, <span class="at">nfold=</span><span class="dv">10</span>, <span class="at">clusterID=</span>village)</span></code></pre></div>
<pre><code>## fold: 1  2  3  4  5  6  7  8  9  10  
## coef (se) = 0.0963494 (0.0243608)</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb65-1" aria-hidden="true" tabindex="-1"></a>resY <span class="ot">=</span>  DML2.RF<span class="sc">$</span>ytil</span>
<span id="cb65-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb65-3" aria-hidden="true" tabindex="-1"></a>resD <span class="ot">=</span>  DML2.RF<span class="sc">$</span>dtil</span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating instance of labelencoder</span></span>
<span id="cb66-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-2" aria-hidden="true" tabindex="-1"></a>labelencoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb66-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning numerical values and storing in another column</span></span>
<span id="cb66-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-5" aria-hidden="true" tabindex="-1"></a>darfurR[<span class="st">&#39;village_clu&#39;</span>] <span class="op">=</span> labelencoder.fit_transform(darfurR[<span class="st">&#39;village&#39;</span>])</span>
<span id="cb66-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create cluster object</span></span>
<span id="cb66-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-8" aria-hidden="true" tabindex="-1"></a>CLU <span class="op">=</span> darfurR[<span class="st">&#39;village_clu&#39;</span>]</span>
<span id="cb66-9"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-9" aria-hidden="true" tabindex="-1"></a>clu <span class="op">=</span> CLU.to_numpy().reshape( <span class="bu">len</span>(Y) , <span class="dv">1</span> )</span>
<span id="cb66-10"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#DML with cross-validated Lasso:</span></span>
<span id="cb66-12"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dreg(x,d):</span>
<span id="cb66-13"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-13" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> RandomForestRegressor( random_state <span class="op">=</span> <span class="dv">0</span> ).fit( x, d )</span>
<span id="cb66-14"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb66-15"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> yreg(x,y):</span>
<span id="cb66-17"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-17" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> RandomForestRegressor( random_state <span class="op">=</span> <span class="dv">0</span> ).fit( x, y )</span>
<span id="cb66-18"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb66-19"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-20"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb66-20" aria-hidden="true" tabindex="-1"></a>DML2_RF <span class="op">=</span> DML2_for_PLM(x, d, y, dreg, yreg, <span class="dv">2</span>, clu)   <span class="co"># set to 2 due to computation time</span></span></code></pre></div>
<pre><code>## 0  
## 1  
## Coefficient is 0.12079217531137135, SE is equal to 0.033980547376392126</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb68-1" aria-hidden="true" tabindex="-1"></a>resY <span class="op">=</span> DML2_RF[<span class="dv">2</span>]</span>
<span id="cb68-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb68-2" aria-hidden="true" tabindex="-1"></a>resD <span class="op">=</span> DML2_RF[<span class="dv">3</span>]</span></code></pre></div>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&quot;Controls explain the following fraction of variance of Outcome&quot;</span>, <span class="fu">max</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(resY)<span class="sc">/</span><span class="fu">var</span>(peacefactorR),<span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Controls explain the following fraction of variance of Outcome&quot;
## [2] &quot;0.0489042746089093&quot;</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb71-1" aria-hidden="true" tabindex="-1"></a>FVU_Y <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.var(resY)<span class="op">/</span>np.var(peacefactorR)</span>
<span id="cb71-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb71-2" aria-hidden="true" tabindex="-1"></a>FVU_D <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> np.var(resD)<span class="op">/</span>np.var(directlyharmedR)</span>
<span id="cb71-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Controls explain the following fraction of variance of Outcome&quot;</span>, FVU_Y)</span></code></pre></div>
<pre><code>## Controls explain the following fraction of variance of Outcome -0.16888432052333724</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&quot;Controls explain the following fraction of variance of Treatment&quot;</span>, <span class="fu">max</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(resD)<span class="sc">/</span><span class="fu">var</span>(directlyharmedR),<span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Controls explain the following fraction of variance of Treatment&quot;
## [2] &quot;0&quot;</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Controls explain the following fraction of variance of treatment&quot;</span>, FVU_D)</span></code></pre></div>
<pre><code>## Controls explain the following fraction of variance of treatment 0.7327860005131104</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb77-1" aria-hidden="true" tabindex="-1"></a>dml.darfur.model<span class="ot">=</span> <span class="fu">lm</span>(resY<span class="sc">~</span>resD) </span>
<span id="cb77-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb77-3" aria-hidden="true" tabindex="-1"></a>dml.darfur.sensitivity <span class="ot">&lt;-</span> <span class="fu">sensemakr</span>(<span class="at">model =</span> dml.darfur.model, </span>
<span id="cb77-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb77-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">treatment =</span> <span class="st">&quot;resD&quot;</span>)</span>
<span id="cb77-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dml.darfur.sensitivity)</span></code></pre></div>
<pre><code>## Sensitivity Analysis to Unobserved Confounding
## 
## Model Formula: resY ~ resD
## 
## Null hypothesis: q = 1 and reduce = TRUE 
## -- This means we are considering biases that reduce the absolute value of the current estimate.
## -- The null hypothesis deemed problematic is H0:tau = 0 
## 
## Unadjusted Estimates of &#39;resD&#39;: 
##   Coef. estimate: 0.0963 
##   Standard Error: 0.0182 
##   t-value (H0:tau = 0): 5.305 
## 
## Sensitivity Statistics:
##   Partial R2 of treatment with outcome: 0.0216 
##   Robustness Value, q = 1: 0.138 
##   Robustness Value, q = 1, alpha = 0.05: 0.0894 
## 
## Verbal interpretation of sensitivity statistics:
## 
## -- Partial R2 of the treatment with the outcome: an extreme confounder (orthogonal to the covariates) that explains 100% of the residual variance of the outcome, would need to explain at least 2.16% of the residual variance of the treatment to fully account for the observed estimated effect.
## 
## -- Robustness Value, q = 1: unobserved confounders (orthogonal to the covariates) that explain more than 13.8% of the residual variance of both the treatment and the outcome are strong enough to bring the point estimate to 0 (a bias of 100% of the original estimate). Conversely, unobserved confounders that do not explain more than 13.8% of the residual variance of both the treatment and the outcome are not strong enough to bring the point estimate to 0.
## 
## -- Robustness Value, q = 1, alpha = 0.05: unobserved confounders (orthogonal to the covariates) that explain more than 8.94% of the residual variance of both the treatment and the outcome are strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0 (a bias of 100% of the original estimate), at the significance level of alpha = 0.05. Conversely, unobserved confounders that do not explain more than 8.94% of the residual variance of both the treatment and the outcome are not strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0, at the significance level of alpha = 0.05.</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-1" aria-hidden="true" tabindex="-1"></a>darfurR[<span class="st">&#39;resY_rf&#39;</span>] <span class="op">=</span> resY</span>
<span id="cb79-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-2" aria-hidden="true" tabindex="-1"></a>darfurR[<span class="st">&#39;resD_rf&#39;</span>] <span class="op">=</span> resD</span>
<span id="cb79-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model to use as input in sensemakr   </span></span>
<span id="cb79-5"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-5" aria-hidden="true" tabindex="-1"></a>dml_darfur_model_rf<span class="op">=</span> smf.ols(<span class="st">&#39;resY_rf~ resD_rf&#39;</span>,data<span class="op">=</span>darfurR ).fit()</span>
<span id="cb79-6"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to double check why the function does not allow to run withour the benchmark_covariates argument</span></span>
<span id="cb79-8"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb79-8" aria-hidden="true" tabindex="-1"></a>sensemakr.Sensemakr(dml_darfur_model_rf, <span class="st">&quot;resD_rf&quot;</span>, benchmark_covariates <span class="op">=</span> <span class="st">&quot;Intercept&quot;</span>)</span></code></pre></div>
<pre><code>## &lt;sensemakr.sensemakr.Sensemakr object at 0x0000000054938430&gt;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb81-1" aria-hidden="true" tabindex="-1"></a>dml_darfur_sensitivity.summary()</span></code></pre></div>
<pre><code>## Sensitivity Analysis to Unobserved Confounding
## 
## Model Formula: resY ~ Intercept + resD
## 
## Null hypothesis: q = 1 and reduce = True 
## 
## -- This means we are considering biases that reduce the absolute value of the current estimate.
## -- The null hypothesis deemed problematic is H0:tau = 0.0 
## 
## Unadjusted Estimates of &#39; resD &#39;:
##   Coef. estimate: 0.1
##   Standard Error: 0.018
##   t-value: 5.491 
## 
## Sensitivity Statistics:
##   Partial R2 of treatment with outcome: 0.023
##   Robustness Value, q = 1 : 0.142
##   Robustness Value, q = 1 alpha = 0.05 : 0.094 
## 
## Verbal interpretation of sensitivity statistics:
## 
## -- Partial R2 of the treatment with the outcome: an extreme confounder (orthogonal to the covariates)  that explains 100% of the residual variance of the outcome, would need to explain at least 2.311921044413477 % of the residual variance of the treatment to fully account for the observed estimated effect.
## 
## -- Robustness Value, q = 1 : unobserved confounders (orthogonal to the covariates) that  explain more than 14.245999027817676 % of the residual variance of both the treatment and the outcome are strong enough to bring the point estimate to 0.0 (a bias of 100.0 % of the original estimate). Conversely, unobserved confounders that do not explain more than 14.245999027817676 % of the residual variance of both the treatment and the outcome are not strong enough to bring the point estimate to 0.0 .
## 
## -- Robustness Value, q = 1 , alpha = 0.05 : unobserved confounders (orthogonal to the covariates) that explain more than 9.408806814165754 % of the residual variance of both the treatment and the outcome are strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0.0 (a bias of 100.0 % of the original estimate), at the significance level of alpha = 0.05 . Conversely, unobserved confounders that do not explain more than 9.408806814165754 % of the residual variance of both the treatment and the outcome are not strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0.0 , at the significance level of alpha = 0.05 .
## 
## Bounds on omitted variable bias:
## --The table below shows the maximum strength of unobserved confounders with association with the treatment and the outcome bounded by a multiple of the observed explanatory power of the chosen benchmark covariate(s).
## 
##     bound_label        r2dz_x  ...  adjusted_lower_CI adjusted_upper_CI
## 0  1x Intercept  2.166013e-18  ...           0.064474          0.136199
## 
## [1 rows x 9 columns]</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a contour plot for the estimate</span></span>
<span id="cb83-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dml.darfur.sensitivity,<span class="at">nlevels =</span> <span class="dv">15</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a contour plot for the estimate</span></span>
<span id="cb84-2"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb84-2" aria-hidden="true" tabindex="-1"></a>ovb_plots.ovb_contour_plot(sense_obj<span class="op">=</span>dml_darfur_sensitivity, sensitivity_of<span class="op">=</span><span class="st">&#39;estimate&#39;</span>)</span>
<span id="cb84-3"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#cb84-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="576" /></p>
</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="doubledebiased-ml-for-partially-linear-iv-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexanderquispe/ml_book/edit/master/29-Sensitivity-Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/alexanderquispe/ml_book/blob/master/29-Sensitivity-Analysis.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
