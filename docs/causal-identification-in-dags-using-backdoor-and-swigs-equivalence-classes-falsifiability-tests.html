<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests | Machine Learning and Causal Inference</title>
  <meta name="description" content="Chapter 12 Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests | Machine Learning and Causal Inference" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests | Machine Learning and Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests | Machine Learning and Causal Inference" />
  
  
  

<meta name="author" content="Alexander Quispe &amp; Anzony Quispe" />


<meta name="date" content="2021-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="functional-approximations-by-trees-and-neural-networks.html"/>
<link rel="next" href="dosearch-for-causal-identification-in-dags.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Machine Learning and Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="predictive-inference.html"><a href="predictive-inference.html"><i class="fa fa-check"></i><b>2</b> Predictive Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="predictive-inference.html"><a href="predictive-inference.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="predictive-inference.html"><a href="predictive-inference.html#data-analysis"><i class="fa fa-check"></i><b>2.2</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="predictive-inference.html"><a href="predictive-inference.html#r-and-python-code"><i class="fa fa-check"></i><b>2.2.1</b> R and Python code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="predictive-inference.html"><a href="predictive-inference.html#prediction-question"><i class="fa fa-check"></i><b>2.3</b> Prediction Question</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="predictive-inference.html"><a href="predictive-inference.html#basic-model"><i class="fa fa-check"></i><b>2.3.1</b> Basic Model:</a></li>
<li class="chapter" data-level="2.3.2" data-path="predictive-inference.html"><a href="predictive-inference.html#flexible-model"><i class="fa fa-check"></i><b>2.3.2</b> Flexible Model:</a></li>
<li class="chapter" data-level="2.3.3" data-path="predictive-inference.html"><a href="predictive-inference.html#lasso-model"><i class="fa fa-check"></i><b>2.3.3</b> Lasso Model:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="predictive-inference.html"><a href="predictive-inference.html#data-splitting"><i class="fa fa-check"></i><b>2.4</b> Data Splitting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html"><i class="fa fa-check"></i><b>3</b> Predictive Inference The Gender Wage Gap</a>
<ul>
<li class="chapter" data-level="3.1" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#data-analysis-1"><i class="fa fa-check"></i><b>3.1</b> Data analysis</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#ols-regression"><i class="fa fa-check"></i><b>3.1.1</b> OLS Regression</a></li>
<li class="chapter" data-level="3.1.2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#ols-regression-with-controls"><i class="fa fa-check"></i><b>3.1.2</b> Ols regression with controls</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#partialling-out-using-ols"><i class="fa fa-check"></i><b>3.2</b> Partialling-Out using ols</a></li>
<li class="chapter" data-level="3.3" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#partialling-out-using-lasso"><i class="fa fa-check"></i><b>3.3</b> Partialling-Out using lasso</a></li>
<li class="chapter" data-level="3.4" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#extra-flexible-model"><i class="fa fa-check"></i><b>3.4</b> “Extra” flexible model</a></li>
<li class="chapter" data-level="3.5" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#laso-extra-flexible-model"><i class="fa fa-check"></i><b>3.5</b> Laso “Extra” Flexible model</a></li>
<li class="chapter" data-level="3.6" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#summarize-the-results"><i class="fa fa-check"></i><b>3.6</b> Summarize the results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html"><i class="fa fa-check"></i><b>4</b> Simple Exercise on Overfitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#first-set-pn"><i class="fa fa-check"></i><b>4.1</b> 1. First set p=n</a></li>
<li class="chapter" data-level="4.2" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#second-set-pn2."><i class="fa fa-check"></i><b>4.2</b> 2. Second, set p=n/2.</a></li>
<li class="chapter" data-level="4.3" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#third-set-pn-.05"><i class="fa fa-check"></i><b>4.3</b> 3. Third, set p/n =.05</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vaccine-rct-examples.html"><a href="vaccine-rct-examples.html"><i class="fa fa-check"></i><b>5</b> Vaccine RCT Examples</a>
<ul>
<li class="chapter" data-level="5.1" data-path="vaccine-rct-examples.html"><a href="vaccine-rct-examples.html#polio-rct"><i class="fa fa-check"></i><b>5.1</b> Polio RCT</a></li>
<li class="chapter" data-level="5.2" data-path="vaccine-rct-examples.html"><a href="vaccine-rct-examples.html#pfizerbntx-covid-19-rct"><i class="fa fa-check"></i><b>5.2</b> Pfizer/BNTX Covid-19 RCT</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="penalized-linear-regressions-a-simulation-experiment.html"><a href="penalized-linear-regressions-a-simulation-experiment.html"><i class="fa fa-check"></i><b>6</b> Penalized Linear Regressions: A Simulation Experiment</a>
<ul>
<li class="chapter" data-level="6.1" data-path="penalized-linear-regressions-a-simulation-experiment.html"><a href="penalized-linear-regressions-a-simulation-experiment.html#data-generating-process-approximately-sparse"><i class="fa fa-check"></i><b>6.1</b> Data Generating Process: Approximately Sparse</a></li>
<li class="chapter" data-level="6.2" data-path="penalized-linear-regressions-a-simulation-experiment.html"><a href="penalized-linear-regressions-a-simulation-experiment.html#data-generating-process-approximately-sparse-small-dense-part"><i class="fa fa-check"></i><b>6.2</b> Data Generating Process: Approximately Sparse + Small Dense Part</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-design.html"><a href="simulation-design.html"><i class="fa fa-check"></i><b>7</b> Simulation Design</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-design.html"><a href="simulation-design.html#example-1"><i class="fa fa-check"></i><b>7.1</b> Example 1</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-design.html"><a href="simulation-design.html#example-2"><i class="fa fa-check"></i><b>7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html"><i class="fa fa-check"></i><b>8</b> Testing the Convergence Hypothesis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#data-analysis-2"><i class="fa fa-check"></i><b>8.2</b> Data analysis</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#ols"><i class="fa fa-check"></i><b>8.2.1</b> OLS</a></li>
<li class="chapter" data-level="8.2.2" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#lasso"><i class="fa fa-check"></i><b>8.2.2</b> Lasso</a></li>
<li class="chapter" data-level="8.2.3" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#summary-results"><i class="fa fa-check"></i><b>8.2.3</b> Summary results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html"><i class="fa fa-check"></i><b>9</b> Machine Learning for wage prediction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#data-1"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#analysis"><i class="fa fa-check"></i><b>9.2</b> Analysis</a></li>
<li class="chapter" data-level="9.3" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#ols-1"><i class="fa fa-check"></i><b>9.3</b> OLS</a></li>
<li class="chapter" data-level="9.4" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#lasso-ridge-and-elastic-net"><i class="fa fa-check"></i><b>9.4</b> Lasso, Ridge and Elastic Net</a></li>
<li class="chapter" data-level="9.5" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#non-linear-models"><i class="fa fa-check"></i><b>9.5</b> Non-linear models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#regression-trees"><i class="fa fa-check"></i><b>9.5.1</b> Regression Trees</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#random-forest-and-boosted-trees"><i class="fa fa-check"></i><b>9.6</b> Random Forest and Boosted Trees</a></li>
<li class="chapter" data-level="9.7" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#results"><i class="fa fa-check"></i><b>9.7</b> Results</a></li>
<li class="chapter" data-level="9.8" data-path="machine-learning-for-wage-prediction.html"><a href="machine-learning-for-wage-prediction.html#ensemble-learning"><i class="fa fa-check"></i><b>9.8</b> Ensemble learning</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="deep-neural-networks-for-wage-prediction.html"><a href="deep-neural-networks-for-wage-prediction.html"><i class="fa fa-check"></i><b>10</b> Deep Neural Networks for Wage Prediction</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deep-neural-networks-for-wage-prediction.html"><a href="deep-neural-networks-for-wage-prediction.html#data-preparation"><i class="fa fa-check"></i><b>10.1</b> Data Preparation</a></li>
<li class="chapter" data-level="10.2" data-path="deep-neural-networks-for-wage-prediction.html"><a href="deep-neural-networks-for-wage-prediction.html#neural-networks"><i class="fa fa-check"></i><b>10.2</b> Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html"><i class="fa fa-check"></i><b>11</b> Functional Approximations by Trees and Neural Networks</a>
<ul>
<li class="chapter" data-level="11.1" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#functional-approximation-by-a-tree"><i class="fa fa-check"></i><b>11.1</b> Functional Approximation by a Tree</a></li>
<li class="chapter" data-level="11.2" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#functional-approximation-by-rf"><i class="fa fa-check"></i><b>11.2</b> Functional Approximation by RF</a></li>
<li class="chapter" data-level="11.3" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#boosted-trees"><i class="fa fa-check"></i><b>11.3</b> Boosted Trees</a></li>
<li class="chapter" data-level="11.4" data-path="functional-approximations-by-trees-and-neural-networks.html"><a href="functional-approximations-by-trees-and-neural-networks.html#same-example-with-a-neural-network"><i class="fa fa-check"></i><b>11.4</b> Same Example with a Neural Network</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><i class="fa fa-check"></i><b>12</b> Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests</a>
<ul>
<li class="chapter" data-level="12.1" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#graph-generation-and-plotting"><i class="fa fa-check"></i><b>12.1</b> Graph Generation and Plotting</a></li>
<li class="chapter" data-level="12.2" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#report-relatives-of-x2"><i class="fa fa-check"></i><b>12.2</b> Report Relatives of X2</a></li>
<li class="chapter" data-level="12.3" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#find-paths-between-d-and-y"><i class="fa fa-check"></i><b>12.3</b> Find Paths Between D and Y</a></li>
<li class="chapter" data-level="12.4" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#list-all-testable-implications-of-the-model"><i class="fa fa-check"></i><b>12.4</b> List All Testable Implications of the Model</a></li>
<li class="chapter" data-level="12.5" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#identification-by-backdoor-list-minimal-adjustment-sets-to-identify-causal-effecs-d-to-y"><i class="fa fa-check"></i><b>12.5</b> Identification by Backdoor: List minimal adjustment sets to identify causal effecs <span class="math inline">\(D \to Y\)</span></a></li>
<li class="chapter" data-level="12.6" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#identification-via-swig-and-d-separation"><i class="fa fa-check"></i><b>12.6</b> Identification via SWIG and D-separation</a></li>
<li class="chapter" data-level="12.7" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#deduce-conditional-exogeneity-or-ignorability-by-d-separation"><i class="fa fa-check"></i><b>12.7</b> Deduce Conditional Exogeneity or Ignorability by D-separation</a></li>
<li class="chapter" data-level="12.8" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#print-all-average-effects-identifiable-by-conditioning"><i class="fa fa-check"></i><b>12.8</b> Print All Average Effects Identifiable by Conditioning</a></li>
<li class="chapter" data-level="12.9" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#equivalence-classes"><i class="fa fa-check"></i><b>12.9</b> Equivalence Classes</a></li>
<li class="chapter" data-level="12.10" data-path="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#example-of-testing-dag-validity"><i class="fa fa-check"></i><b>12.10</b> Example of Testing DAG Validity</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dosearch-for-causal-identification-in-dags.html"><a href="dosearch-for-causal-identification-in-dags.html"><i class="fa fa-check"></i><b>13</b> Dosearch for Causal Identification in DAGs</a></li>
<li class="chapter" data-level="14" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><i class="fa fa-check"></i><b>14</b> A Case Study: The Effect of Gun Ownership on Gun-Homicide Rates</a>
<ul>
<li class="chapter" data-level="14.1" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#data-2"><i class="fa fa-check"></i><b>14.1</b> Data</a></li>
<li class="chapter" data-level="14.2" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#preprocessing."><i class="fa fa-check"></i><b>14.2</b> Preprocessing.</a></li>
<li class="chapter" data-level="14.3" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#the-effect-of-gun-ownership"><i class="fa fa-check"></i><b>14.3</b> The effect of gun ownership</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#ols-2"><i class="fa fa-check"></i><b>14.3.1</b> OLS</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#dml-algorithm"><i class="fa fa-check"></i><b>14.4</b> DML algorithm</a></li>
<li class="chapter" data-level="14.5" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#lasso-1"><i class="fa fa-check"></i><b>14.5</b> Lasso</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html"><a href="a-case-study-the-effect-of-gun-ownership-on-gun-homicide-rates.html#random-forest"><i class="fa fa-check"></i><b>14.5.1</b> Random Forest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><a href="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><i class="fa fa-check"></i><b>15</b> The Effect of Gun Ownership on Gun-Homicide Rates using DML for neural nets</a>
<ul>
<li class="chapter" data-level="15.1" data-path="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><a href="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html#dml-for-neural-nets"><i class="fa fa-check"></i><b>15.1</b> DML for neural nets</a></li>
<li class="chapter" data-level="15.2" data-path="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html"><a href="the-effect-of-gun-ownership-on-gun-homicide-rates-using-dml-for-neural-nets.html#estimating-the-effect-with-dlm-for-neural-nets"><i class="fa fa-check"></i><b>15.2</b> Estimating the effect with DLM for neural nets</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><i class="fa fa-check"></i><b>16</b> Inference on Predictive and Causal Effects in High-Dimensional Nonlinear Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#impact-of-401k-on-financial-wealth"><i class="fa fa-check"></i><b>16.1</b> Impact of 401(k) on Financial Wealth</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#data-3"><i class="fa fa-check"></i><b>16.1.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#double-ml-package"><i class="fa fa-check"></i><b>16.2</b> Double ML package</a></li>
<li class="chapter" data-level="16.3" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#estimating-the-ate-of-401k-eligibility-on-net-financial-assets"><i class="fa fa-check"></i><b>16.3</b> Estimating the ATE of 401(k) Eligibility on Net Financial Assets</a></li>
<li class="chapter" data-level="16.4" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#partially-linear-regression-models-plr"><i class="fa fa-check"></i><b>16.4</b> Partially Linear Regression Models (PLR)</a></li>
<li class="chapter" data-level="16.5" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#interactive-regression-model-irm"><i class="fa fa-check"></i><b>16.5</b> Interactive Regression Model (IRM)</a></li>
<li class="chapter" data-level="16.6" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#local-average-treatment-effects-of-401k-participation-on-net-financial-assets"><i class="fa fa-check"></i><b>16.6</b> Local Average Treatment Effects of 401(k) Participation on Net Financial Assets</a></li>
<li class="chapter" data-level="16.7" data-path="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html"><a href="inference-on-predictive-and-causal-effects-in-high-dimensional-nonlinear-models.html#interactive-iv-model-iivm"><i class="fa fa-check"></i><b>16.7</b> Interactive IV Model (IIVM)</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><i class="fa fa-check"></i><b>17</b> Using Dagitty in the Analysis of Impact of 401(k) on Net Financial Wealth</a>
<ul>
<li class="chapter" data-level="17.1" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#graphs-for-401k-analsyis"><i class="fa fa-check"></i><b>17.1</b> Graphs for 401(K) Analsyis</a></li>
<li class="chapter" data-level="17.2" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#state-one-graph-where-f-determines-x-and-plot-it"><i class="fa fa-check"></i><b>17.2</b> State one graph (where F determines X) and plot it</a></li>
<li class="chapter" data-level="17.3" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#list-minimal-adjustment-sets-to-identify-causal-effecs-d-to-y"><i class="fa fa-check"></i><b>17.3</b> List minimal adjustment sets to identify causal effecs <span class="math inline">\(D \to Y\)</span></a></li>
<li class="chapter" data-level="17.4" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#what-is-the-underlying-principle"><i class="fa fa-check"></i><b>17.4</b> What is the underlying principle?</a></li>
<li class="chapter" data-level="17.5" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#another-graph-wherere-x-determine-f"><i class="fa fa-check"></i><b>17.5</b> Another Graph (wherere <span class="math inline">\(X\)</span> determine <span class="math inline">\(F\)</span>):</a></li>
<li class="chapter" data-level="17.6" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#one-more-graph-encompassing-previous-ones-where-f-x-are-jointly-determined-by-latent-factors-a.-we-can-allow-in-fact-the-whole-triple-d-f-x-to-be-jointly-determined-by-latent-factors-a."><i class="fa fa-check"></i><b>17.6</b> One more graph (encompassing previous ones), where (F, X) are jointly determined by latent factors <span class="math inline">\(A\)</span>. We can allow in fact the whole triple (D, F, X) to be jointly determined by latent factors <span class="math inline">\(A\)</span>.</a></li>
<li class="chapter" data-level="17.7" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#threat-to-idenitification-what-if-f-also-directly-affects-y-note-that-there-are-no-valid-adjustment-sets-in-this-case"><i class="fa fa-check"></i><b>17.7</b> Threat to Idenitification: What if <span class="math inline">\(F\)</span> also directly affects <span class="math inline">\(Y\)</span>? (Note that there are no valid adjustment sets in this case)</a></li>
<li class="chapter" data-level="17.8" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#introduce-match-amount-m-very-important-mediator-why-mediator.-m-is-not-observed.-luckily-adjusting-for-x-still-works-if-there-is-no-f-to-m-arrow."><i class="fa fa-check"></i><b>17.8</b> Introduce Match Amount <span class="math inline">\(M\)</span> (very important mediator, why mediator?). <span class="math inline">\(M\)</span> is not observed. Luckily adjusting for <span class="math inline">\(X\)</span> still works if there is no <span class="math inline">\(F \to M\)</span> arrow.</a></li>
<li class="chapter" data-level="17.9" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#if-there-is-f-to-m-arrow-then-adjusting-for-x-is-not-sufficient."><i class="fa fa-check"></i><b>17.9</b> If there is <span class="math inline">\(F \to M\)</span> arrow, then adjusting for <span class="math inline">\(X\)</span> is not sufficient.</a></li>
<li class="chapter" data-level="17.10" data-path="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html"><a href="using-dagitty-in-the-analysis-of-impact-of-401k-on-net-financial-wealth.html#question"><i class="fa fa-check"></i><b>17.10</b> Question:</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"><a href="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"><i class="fa fa-check"></i><b>18</b> Double/Debiased Machine Learning for the Partially Linear Regression Model.</a>
<ul>
<li class="chapter" data-level="18.1" data-path="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html"><a href="doubledebiased-machine-learning-for-the-partially-linear-regression-model..html#dml-algorithm-1"><i class="fa fa-check"></i><b>18.1</b> DML algorithm</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><i class="fa fa-check"></i><b>19</b> Sensititivy Analysis for Unobserved Confounder with DML and Sensmakr</a>
<ul>
<li class="chapter" data-level="19.1" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#here-we-experiment-with-using-package-sensemakr-in-conjunction-with-debiased-ml"><i class="fa fa-check"></i><b>19.1</b> Here we experiment with using package “sensemakr” in conjunction with debiased ML</a></li>
<li class="chapter" data-level="19.2" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#we-will"><i class="fa fa-check"></i><b>19.2</b> We will</a></li>
<li class="chapter" data-level="19.3" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#take-out-village-fixed-effects-and-run-basic-linear-analysis"><i class="fa fa-check"></i><b>19.3</b> Take out village fixed effects and run basic linear analysis</a></li>
<li class="chapter" data-level="19.4" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#we-first-use-lasso-for-partilling-out-controls"><i class="fa fa-check"></i><b>19.4</b> We first use Lasso for Partilling Out Controls</a></li>
<li class="chapter" data-level="19.5" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#manual-bias-analysis"><i class="fa fa-check"></i><b>19.5</b> Manual Bias Analysis</a></li>
<li class="chapter" data-level="19.6" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#bias-analysis-with-sensemakr"><i class="fa fa-check"></i><b>19.6</b> Bias Analysis with Sensemakr</a></li>
<li class="chapter" data-level="19.7" data-path="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html"><a href="sensititivy-analysis-for-unobserved-confounder-with-dml-and-sensmakr.html#next-we-use-random-forest-as-ml-tool-for-partialling-out"><i class="fa fa-check"></i><b>19.7</b> Next We use Random Forest as ML tool for Partialling Out</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html"><i class="fa fa-check"></i><b>20</b> Double/Debiased ML for Partially Linear IV Model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#partially-linear-iv-model"><i class="fa fa-check"></i><b>20.1</b> Partially Linear IV Model</a></li>
<li class="chapter" data-level="20.2" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#example"><i class="fa fa-check"></i><b>20.2</b> Example</a></li>
<li class="chapter" data-level="20.3" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#plivm-in-residualized-form"><i class="fa fa-check"></i><b>20.3</b> PLIVM in Residualized Form</a></li>
<li class="chapter" data-level="20.4" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#dml-for-pliv-model"><i class="fa fa-check"></i><b>20.4</b> DML for PLIV Model</a></li>
<li class="chapter" data-level="20.5" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#emprical-example-acemoglu-jonsohn-robinson-aer."><i class="fa fa-check"></i><b>20.5</b> Emprical Example: Acemoglu, Jonsohn, Robinson (AER).</a></li>
<li class="chapter" data-level="20.6" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#examine-if-we-have-weak-instruments"><i class="fa fa-check"></i><b>20.6</b> Examine if we have weak instruments</a></li>
<li class="chapter" data-level="20.7" data-path="doubledebiased-ml-for-partially-linear-iv-model.html"><a href="doubledebiased-ml-for-partially-linear-iv-model.html#we-do-have-weak-instruments-because-t-stats-in-regression-tilde-d-sim-tilde-z-are-less-than-4-in-absolute-value"><i class="fa fa-check"></i><b>20.7</b> We do have weak instruments, because t-stats in regression <span class="math inline">\(\tilde D \sim \tilde Z\)</span> are less than 4 in absolute value</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><i class="fa fa-check"></i><b>21</b> A Simple Example of Properties of IV estimator when Instruments are Weak</a>
<ul>
<li class="chapter" data-level="21.1" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html#run-1000-trials-to-evaluate-distribution-of-the-iv-estimator"><i class="fa fa-check"></i><b>21.1</b> Run 1000 trials to evaluate distribution of the IV estimator</a></li>
<li class="chapter" data-level="21.2" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html#plot-the-actual-distribution-against-the-normal-approximation-based-on-strong-instrument-assumption"><i class="fa fa-check"></i><b>21.2</b> Plot the Actual Distribution against the Normal Approximation (based on Strong Instrument Assumption)</a></li>
<li class="chapter" data-level="21.3" data-path="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html"><a href="a-simple-example-of-properties-of-iv-estimator-when-instruments-are-weak.html#some-help-functions"><i class="fa fa-check"></i><b>21.3</b> Some Help Functions</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html"><i class="fa fa-check"></i><b>22</b> HTE I: Binary treatment</a>
<ul>
<li class="chapter" data-level="22.1" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#pre-specified-hypotheses"><i class="fa fa-check"></i><b>22.1</b> Pre-specified hypotheses</a></li>
<li class="chapter" data-level="22.2" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#data-driven-hypotheses"><i class="fa fa-check"></i><b>22.2</b> Data-driven hypotheses</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#via-causal-trees"><i class="fa fa-check"></i><b>22.2.1</b> Via causal trees</a></li>
<li class="chapter" data-level="22.2.2" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#via-grf"><i class="fa fa-check"></i><b>22.2.2</b> Via grf</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="hte-i-binary-treatment.html"><a href="hte-i-binary-treatment.html#further-reading"><i class="fa fa-check"></i><b>22.3</b> Further reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning and Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Causal Identification in DAGs using Backdoor and Swigs, Equivalence Classes, Falsifiability Tests</h1>
<style>
  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }
  .col3 {
    columns: 3 100px;
    -webkit-columns: 3 100px;
    -moz-columns: 3 100px;
  }
</style>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading package</span></span>
<span id="cb1-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span></code></pre></div>
<pre><code>## Warning: package &#39;dagitty&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggdag&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## 
## Attaching package: &#39;ggdag&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
<div id="graph-generation-and-plotting" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Graph Generation and Plotting</h2>
<p>The following DAG is due to Judea Pearl</p>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a couple of DAGs and plot them</span></span>
<span id="cb8-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-3" aria-hidden="true" tabindex="-1"></a>G <span class="ot">=</span> <span class="fu">dagitty</span>(<span class="st">&#39;dag{</span></span>
<span id="cb8-4"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">Z1 [pos=&quot;-2,-1.5&quot;]</span></span>
<span id="cb8-5"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">X1 [pos=&quot;-2,0&quot;]</span></span>
<span id="cb8-6"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">Z2 [pos=&quot;1.5,-1.5&quot;]</span></span>
<span id="cb8-7"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">X3 [pos=&quot;1.5, 0&quot;]</span></span>
<span id="cb8-8"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">Y [outcome,pos=&quot;1.5,1.5&quot;]</span></span>
<span id="cb8-9"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">D [exposure,pos=&quot;-2,1.5&quot;]</span></span>
<span id="cb8-10"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">M [mediator, pos=&quot;0,1.5&quot;]</span></span>
<span id="cb8-11"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">X2 [pos=&quot;0,0&quot;]</span></span>
<span id="cb8-12"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">Z1 -&gt; X1</span></span>
<span id="cb8-13"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">X1 -&gt; D</span></span>
<span id="cb8-14"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">Z1 -&gt; X2</span></span>
<span id="cb8-15"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">Z2 -&gt; X3</span></span>
<span id="cb8-16"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">X3 -&gt; Y</span></span>
<span id="cb8-17"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">Z2 -&gt; X2</span></span>
<span id="cb8-18"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">D -&gt; Y</span></span>
<span id="cb8-19"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">X2 -&gt; Y</span></span>
<span id="cb8-20"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">X2 -&gt; D</span></span>
<span id="cb8-21"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">M-&gt;Y</span></span>
<span id="cb8-22"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">D-&gt;M</span></span>
<span id="cb8-23"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span>
<span id="cb8-24"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(G)<span class="sc">+</span>  <span class="fu">theme_dag</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="report-relatives-of-x2" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Report Relatives of X2</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">parents</span>(G, <span class="st">&quot;X2&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Z1&quot; &quot;Z2&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">children</span>(G, <span class="st">&quot;X2&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;D&quot; &quot;Y&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ancestors</span>(G, <span class="st">&quot;X2&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;X2&quot; &quot;Z2&quot; &quot;Z1&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">descendants</span>(G, <span class="st">&quot;X2&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;X2&quot; &quot;Y&quot;  &quot;D&quot;  &quot;M&quot;</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="find-paths-between-d-and-y" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Find Paths Between D and Y</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paths</span>(G, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<pre><code>## $paths
## [1] &quot;D -&gt; M -&gt; Y&quot;                         
## [2] &quot;D -&gt; Y&quot;                              
## [3] &quot;D &lt;- X1 &lt;- Z1 -&gt; X2 -&gt; Y&quot;            
## [4] &quot;D &lt;- X1 &lt;- Z1 -&gt; X2 &lt;- Z2 -&gt; X3 -&gt; Y&quot;
## [5] &quot;D &lt;- X2 -&gt; Y&quot;                        
## [6] &quot;D &lt;- X2 &lt;- Z2 -&gt; X3 -&gt; Y&quot;            
## 
## $open
## [1]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="list-all-testable-implications-of-the-model" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> List All Testable Implications of the Model</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">impliedConditionalIndependencies</span>(G) )</span></code></pre></div>
<pre><code>## D _||_ X3 | Z2
## D _||_ X3 | X2, Z1
## D _||_ X3 | X1, X2
## D _||_ Z1 | X1, X2
## D _||_ Z2 | X2, Z1
## D _||_ Z2 | X1, X2
## M _||_ X1 | D
## M _||_ X2 | D
## M _||_ X3 | Z2
## M _||_ X3 | X2, Z1
## M _||_ X3 | X1, X2
## M _||_ X3 | D
## M _||_ Z1 | X1, X2
## M _||_ Z1 | D
## M _||_ Z2 | X2, Z1
## M _||_ Z2 | X1, X2
## M _||_ Z2 | D
## X1 _||_ X2 | Z1
## X1 _||_ X3
## X1 _||_ Y | D, X2, X3
## X1 _||_ Y | D, X2, Z2
## X1 _||_ Y | D, X2, Z1
## X1 _||_ Z2
## X2 _||_ X3 | Z2
## X3 _||_ Z1
## Y _||_ Z1 | X1, X2, Z2
## Y _||_ Z1 | D, X2, Z2
## Y _||_ Z1 | X1, X2, X3
## Y _||_ Z1 | D, X2, X3
## Y _||_ Z2 | X2, X3, Z1
## Y _||_ Z2 | X1, X2, X3
## Y _||_ Z2 | D, X2, X3
## Z1 _||_ Z2</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="identification-by-backdoor-list-minimal-adjustment-sets-to-identify-causal-effecs-d-to-y" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Identification by Backdoor: List minimal adjustment sets to identify causal effecs <span class="math inline">\(D \to Y\)</span></h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">adjustmentSets</span>( G, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Y&quot;</span> ) )</span></code></pre></div>
<pre><code>## { X2, X3 }
## { X2, Z2 }
## { X2, Z1 }
## { X1, X2 }</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="identification-via-swig-and-d-separation" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Identification via SWIG and D-separation</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-1" aria-hidden="true" tabindex="-1"></a>SWIG <span class="ot">=</span> <span class="fu">dagitty</span>(<span class="st">&#39;dag{</span></span>
<span id="cb23-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="st">Z1 [pos=&quot;-2,-1.5&quot;]</span></span>
<span id="cb23-3"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">X1 [pos=&quot;-2,0&quot;]</span></span>
<span id="cb23-4"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">Z2 [pos=&quot;1.5,-1.5&quot;]</span></span>
<span id="cb23-5"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">X3 [pos=&quot;1.5, 0&quot;]</span></span>
<span id="cb23-6"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">Yd [outcome,pos=&quot;1.5,1.5&quot;]</span></span>
<span id="cb23-7"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">D [exposure,pos=&quot;-2,1.5&quot;]</span></span>
<span id="cb23-8"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">d [pos=&quot;-1, 1.5&quot;]</span></span>
<span id="cb23-9"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="st">Md [mediator, pos=&quot;0,1.5&quot;]</span></span>
<span id="cb23-10"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="st">X2 [pos=&quot;0,0&quot;]</span></span>
<span id="cb23-11"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="st">Z1 -&gt; X1</span></span>
<span id="cb23-12"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="st">X1 -&gt; D</span></span>
<span id="cb23-13"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="st">Z1 -&gt; X2</span></span>
<span id="cb23-14"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="st">Z2 -&gt; X3</span></span>
<span id="cb23-15"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="st">X3 -&gt; Yd</span></span>
<span id="cb23-16"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="st">Z2 -&gt; X2</span></span>
<span id="cb23-17"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="st">X2 -&gt; Yd</span></span>
<span id="cb23-18"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="st">X2 -&gt; D</span></span>
<span id="cb23-19"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="st">X3-&gt; Yd</span></span>
<span id="cb23-20"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="st">Md-&gt; Yd</span></span>
<span id="cb23-21"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="st">d-&gt; Md</span></span>
<span id="cb23-22"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span>
<span id="cb23-23"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(SWIG)<span class="sc">+</span>  <span class="fu">theme_dag</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="deduce-conditional-exogeneity-or-ignorability-by-d-separation" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> Deduce Conditional Exogeneity or Ignorability by D-separation</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">impliedConditionalIndependencies</span>(SWIG)[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>] )</span></code></pre></div>
<pre><code>## D _||_ Yd | X2, X3
## D _||_ Yd | X2, Z2
## D _||_ Yd | X2, Z1
## D _||_ Yd | X1, X2</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="print-all-average-effects-identifiable-by-conditioning" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Print All Average Effects Identifiable by Conditioning</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> <span class="fu">names</span>(G) ){</span>
<span id="cb26-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>( m <span class="cf">in</span> <span class="fu">children</span>(G,n) ){</span>
<span id="cb26-3"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-3" aria-hidden="true" tabindex="-1"></a>        a <span class="ot">&lt;-</span> <span class="fu">adjustmentSets</span>( G, n, m )</span>
<span id="cb26-4"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>( <span class="fu">length</span>(a) <span class="sc">&gt;</span> <span class="dv">0</span> ){</span>
<span id="cb26-5"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">&quot;The effect &quot;</span>,n,<span class="st">&quot;-&gt;&quot;</span>,m,</span>
<span id="cb26-6"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot; is identifiable by controlling for:</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb26-7"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">print</span>( a, <span class="at">prefix=</span><span class="st">&quot; * &quot;</span> )</span>
<span id="cb26-8"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-9"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-10"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb26-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## The effect D-&gt;M is identifiable by controlling for:
##  *  {}
## The effect D-&gt;Y is identifiable by controlling for:
## { X2, X3 }
## { X2, Z2 }
## { X2, Z1 }
## { X1, X2 }
## The effect M-&gt;Y is identifiable by controlling for:
## { D }
## The effect X1-&gt;D is identifiable by controlling for:
## { X2 }
## { Z1 }
## The effect X2-&gt;D is identifiable by controlling for:
## { X1 }
## { Z1 }
## The effect X2-&gt;Y is identifiable by controlling for:
## { X1, X3 }
## { X1, Z2 }
## { X3, Z1 }
## { Z1, Z2 }
## The effect X3-&gt;Y is identifiable by controlling for:
## { D, X2 }
## { X1, X2 }
## { X2, Z1 }
## { Z2 }
## The effect Z1-&gt;X1 is identifiable by controlling for:
##  *  {}
## The effect Z1-&gt;X2 is identifiable by controlling for:
##  *  {}
## The effect Z2-&gt;X2 is identifiable by controlling for:
##  *  {}
## The effect Z2-&gt;X3 is identifiable by controlling for:
##  *  {}</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="equivalence-classes" class="section level2" number="12.9">
<h2><span class="header-section-number">12.9</span> Equivalence Classes</h2>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb28-1" aria-hidden="true" tabindex="-1"></a>P<span class="ot">=</span><span class="fu">equivalenceClass</span>(G)</span>
<span id="cb28-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(P)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
<p>Next Consider the elemntary Triangular Model:
<span class="math display">\[
D \to Y, \quad X \to (D,Y).
\]</span>
This model has not testable implications and is Markov-equivalent to any other DAG difined on names <span class="math inline">\((X, D, Y)\)</span>.</p>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-1" aria-hidden="true" tabindex="-1"></a>G3<span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&#39;dag{</span></span>
<span id="cb29-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="st">D -&gt; Y</span></span>
<span id="cb29-3"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st">X -&gt; D</span></span>
<span id="cb29-4"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">X -&gt; Y</span></span>
<span id="cb29-5"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb29-6"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb29-7"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(G3)<span class="sc">+</span>  <span class="fu">theme_dag</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">impliedConditionalIndependencies</span>(G3))</span></code></pre></div>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb31-1" aria-hidden="true" tabindex="-1"></a>P<span class="ot">=</span><span class="fu">equivalenceClass</span>(G3)</span>
<span id="cb31-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(P)</span></code></pre></div>
<pre><code>## Plot coordinates for graph not supplied! Generating coordinates, see ?coordinates for how to set your own.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">equivalentDAGs</span>(G3,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [[1]]
## dag {
## D
## X
## Y
## D -&gt; Y
## X -&gt; D
## X -&gt; Y
## }
## 
## [[2]]
## dag {
## D
## X
## Y
## D -&gt; X
## D -&gt; Y
## X -&gt; Y
## }
## 
## [[3]]
## dag {
## D
## X
## Y
## D -&gt; X
## D -&gt; Y
## Y -&gt; X
## }
## 
## [[4]]
## dag {
## D
## X
## Y
## X -&gt; D
## X -&gt; Y
## Y -&gt; D
## }
## 
## [[5]]
## dag {
## D
## X
## Y
## X -&gt; D
## Y -&gt; D
## Y -&gt; X
## }
## 
## [[6]]
## dag {
## D
## X
## Y
## D -&gt; X
## Y -&gt; D
## Y -&gt; X
## }</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
</div>
<div id="example-of-testing-dag-validity" class="section level2" number="12.10">
<h2><span class="header-section-number">12.10</span> Example of Testing DAG Validity</h2>
<p>Next we simulate the data from a Linear SEM associated to DAG G, and perform a test of conditional independence restrictions, exploting linearity.</p>
<p>There are many other options for nonlinear models and discrete categorical variables. Type help(localTests).</p>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb35-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb35-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">simulateSEM</span>(G)</span>
<span id="cb35-3"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code></pre></div>
<pre><code>##            D           M         X1         X2          X3          Y
## 1 -0.8474441 -0.58585206 -0.7012941  0.5498830  0.19655958  0.9116779
## 2 -1.6262148  2.00395356 -1.8377283 -0.7095460 -0.50443494 -0.2215374
## 3  0.1614541  1.01051345 -1.4470186  0.3221004 -0.02075701 -0.2469239
## 4  2.3009195 -2.82279254 -0.3189441 -1.8295047 -0.70087536 -1.5760471
## 5  1.0838933  0.06353048  0.9142856 -0.9856389  0.55416859  0.3526000
## 6 -1.7508287 -0.17593255 -1.5993489 -0.1865325  0.01467747  0.1302770
##           Z1          Z2
## 1  0.7263907 -0.89149285
## 2 -0.8513481 -0.02621535
## 3 -0.8426767  0.62002207
## 4 -0.9636417  1.54962139
## 5 -0.1109774  1.63705061
## 6  1.5156057 -1.11707145</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cov(x)</span></span>
<span id="cb37-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">localTests</span>(G, <span class="at">data =</span> x, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;cis&quot;</span>))</span></code></pre></div>
<pre><code>##                            estimate    p.value         2.5%      97.5%
## D _||_ X3 | Z2          0.035622986 0.42737161 -0.052319125 0.12301869
## D _||_ X3 | X2, Z1      0.016471580 0.71399002 -0.071498675 0.10418826
## D _||_ X3 | X1, X2      0.039926831 0.37411682 -0.048108613 0.12734896
## D _||_ Z1 | X1, X2     -0.067806530 0.13080922 -0.154757149 0.02018035
## D _||_ Z2 | X2, Z1      0.021481285 0.63264882 -0.066510991 0.10914297
## D _||_ Z2 | X1, X2      0.010402617 0.81696370 -0.077535091 0.09818014
## M _||_ X1 | D           0.003036436 0.94608428 -0.084764936 0.09079114
## M _||_ X2 | D          -0.020310731 0.65097821 -0.107897832 0.06758835
## M _||_ X3 | Z2          0.035998270 0.42251471 -0.051944379 0.12338879
## M _||_ X3 | X2, Z1      0.034793414 0.43868413 -0.053236017 0.12228805
## M _||_ X3 | X1, X2      0.031167443 0.48789766 -0.056854949 0.11871058
## M _||_ X3 | D           0.037606341 0.40207107 -0.050338336 0.12497433
## M _||_ Z1 | X1, X2     -0.010507345 0.81515401 -0.098283869 0.07743098
## M _||_ Z1 | D          -0.027709489 0.53705161 -0.115209116 0.06021551
## M _||_ Z2 | X2, Z1      0.011402844 0.79972096 -0.076540670 0.09917077
## M _||_ Z2 | X1, X2      0.013380830 0.76591502 -0.074573653 0.10112929
## M _||_ Z2 | D           0.024889342 0.57928702 -0.063026909 0.11242342
## X1 _||_ X2 | Z1        -0.043270357 0.33490621 -0.130555519 0.04467784
## X1 _||_ X3             -0.030635229 0.49449301 -0.118010328 0.05720909
## X1 _||_ Y | D, X2, X3   0.050645849 0.25990141 -0.037476176 0.13798962
## X1 _||_ Y | D, X2, Z2   0.004868494 0.91383028 -0.083122446 0.09278430
## X1 _||_ Y | D, X2, Z1  -0.011695259 0.79490082 -0.099548593 0.07633852
## X1 _||_ Z2              0.023442866 0.60116966 -0.064380143 0.11090659
## X2 _||_ X3 | Z2        -0.044212519 0.32447580 -0.131483376 0.04373571
## X3 _||_ Z1              0.014336258 0.74925094 -0.073446806 0.10189948
## Y _||_ Z1 | X1, X2, Z2  0.072416636 0.10688305 -0.015638050 0.15936362
## Y _||_ Z1 | D, X2, Z2   0.062757076 0.16250945 -0.025337865 0.14988990
## Y _||_ Z1 | X1, X2, X3  0.089653462 0.04571531  0.001711880 0.17623042
## Y _||_ Z1 | D, X2, X3   0.085652185 0.05634070 -0.002320376 0.17231940
## Y _||_ Z2 | X2, X3, Z1 -0.037725229 0.40153484 -0.125266732 0.05039710
## Y _||_ Z2 | X1, X2, X3 -0.031782983 0.47978394 -0.119405898 0.05632960
## Y _||_ Z2 | D, X2, X3  -0.026775802 0.55166686 -0.114462634 0.06132376
## Z1 _||_ Z2             -0.061816135 0.16763062 -0.148705546 0.02601547</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>
<p>Next we replaced <span class="math inline">\(D\)</span> by <span class="math inline">\(\bar D\)</span> generated differently:
<span class="math display">\[
\bar D= (D + Y)/2
\]</span>
So basically <span class="math inline">\(\bar D\)</span> is an average of <span class="math inline">\(D\)</span> and <span class="math inline">\(Y\)</span> generated by <span class="math inline">\(D\)</span>. We then test if the resulting collection of random variables satisifes conditional indepdendence restrictions, exploiting linearity. We end up rejectiong these restrictions and thefore the validity of this model for the data generated in this way. This makes sense, because the new data no longer obeys the previous DAG structure.</p>
<div class="columns">
<div class="column" style="width:49.5%;">
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb39-1" aria-hidden="true" tabindex="-1"></a>x.R <span class="ot">=</span> x</span>
<span id="cb39-2"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb39-2" aria-hidden="true" tabindex="-1"></a>x.R<span class="sc">$</span>D <span class="ot">=</span> (x<span class="sc">$</span>D<span class="sc">+</span> x<span class="sc">$</span>Y)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb39-3"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="causal-identification-in-dags-using-backdoor-and-swigs-equivalence-classes-falsifiability-tests.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">localTests</span>(G, <span class="at">data =</span> x.R, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;cis&quot;</span>))</span></code></pre></div>
<pre><code>##                            estimate      p.value        2.5%       97.5%
## D _||_ X3 | Z2          0.495232256 1.157134e-33  0.42697450  0.56288383
## D _||_ X3 | X2, Z1      0.518071072 2.604425e-37  0.45206603  0.58462121
## D _||_ X3 | X1, X2      0.575983100 2.622904e-48  0.51681228  0.63998753
## D _||_ Z1 | X1, X2     -0.005755708 8.981032e-01 -0.09357551  0.08215274
## D _||_ Z2 | X2, Z1     -0.143108556 1.346074e-03 -0.22814881 -0.05594543
## D _||_ Z2 | X1, X2     -0.163192808 2.487265e-04 -0.24757363 -0.07642216
## M _||_ X1 | D          -0.129098627 3.836547e-03 -0.21447770 -0.04179376
## M _||_ X2 | D           0.101698217 2.303920e-02  0.01404511  0.18781599
## M _||_ X3 | Z2          0.035998270 4.225147e-01 -0.05194438  0.12338879
## M _||_ X3 | X2, Z1      0.034793414 4.386841e-01 -0.05323602  0.12228805
## M _||_ X3 | X1, X2      0.031167443 4.878977e-01 -0.05685495  0.11871058
## M _||_ X3 | D           0.098181473 2.825899e-02  0.01049342  0.18438538
## M _||_ Z1 | X1, X2     -0.010507345 8.151540e-01 -0.09828387  0.07743098
## M _||_ Z1 | D          -0.020488073 6.481348e-01 -0.10807319  0.06741174
## M _||_ Z2 | X2, Z1      0.011402844 7.997210e-01 -0.07654067  0.09917077
## M _||_ Z2 | X1, X2      0.013380830 7.659150e-01 -0.07457365  0.10112929
## M _||_ Z2 | D          -0.060513384 1.772260e-01 -0.14751303  0.02741070
## X1 _||_ X2 | Z1        -0.043270357 3.349062e-01 -0.13055552  0.04467784
## X1 _||_ X3             -0.030635229 4.944930e-01 -0.11801033  0.05720909
## X1 _||_ Y | D, X2, X3  -0.327390476 4.197819e-14 -0.40448127 -0.24659654
## X1 _||_ Y | D, X2, Z2  -0.422336837 1.328412e-23 -0.49413839 -0.34763424
## X1 _||_ Y | D, X2, Z1  -0.436724867 2.334230e-25 -0.50771267 -0.36314146
## X1 _||_ Z2              0.023442866 6.011697e-01 -0.06438014  0.11090659
## X2 _||_ X3 | Z2        -0.044212519 3.244758e-01 -0.13148338  0.04373571
## X3 _||_ Z1              0.014336258 7.492509e-01 -0.07344681  0.10189948
## Y _||_ Z1 | X1, X2, Z2  0.072416636 1.068831e-01 -0.01563805  0.15936362
## Y _||_ Z1 | D, X2, Z2  -0.011415266 7.997057e-01 -0.09927132  0.07661692
## Y _||_ Z1 | X1, X2, X3  0.089653462 4.571531e-02  0.00171188  0.17623042
## Y _||_ Z1 | D, X2, X3   0.022842616 6.116000e-01 -0.06524363  0.11057664
## Y _||_ Z2 | X2, X3, Z1 -0.037725229 4.015348e-01 -0.12526673  0.05039710
## Y _||_ Z2 | X1, X2, X3 -0.031782983 4.797839e-01 -0.11940590  0.05632960
## Y _||_ Z2 | D, X2, X3  -0.040190394 3.714516e-01 -0.12769636  0.04793415
## Z1 _||_ Z2             -0.061816135 1.676306e-01 -0.14870555  0.02601547</code></pre>
</div><div class="column" style="width:1%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:49.5%;">

</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="functional-approximations-by-trees-and-neural-networks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dosearch-for-causal-identification-in-dags.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexanderquispe/ml_book/edit/master/22-notebook_daggity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/alexanderquispe/ml_book/blob/master/22-notebook_daggity.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
