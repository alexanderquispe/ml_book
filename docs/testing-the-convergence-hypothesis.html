<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Testing the Convergence Hypothesis | Machine Learning and Causal Inference</title>
  <meta name="description" content="Chapter 4 Testing the Convergence Hypothesis | Machine Learning and Causal Inference" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Testing the Convergence Hypothesis | Machine Learning and Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Testing the Convergence Hypothesis | Machine Learning and Causal Inference" />
  
  
  

<meta name="author" content="Alexander Quispe" />


<meta name="date" content="2021-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-exercise-on-overfitting.html"/>
<link rel="next" href="simulation-design.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Machine Learning and Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Predictive Inference 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-analysis"><i class="fa fa-check"></i><b>1.2</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#r-and-python-code"><i class="fa fa-check"></i><b>1.2.1</b> R and Python code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prediction-question"><i class="fa fa-check"></i><b>1.3</b> Prediction Question</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#basic-model"><i class="fa fa-check"></i><b>1.3.1</b> Basic Model:</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#flexible-model"><i class="fa fa-check"></i><b>1.3.2</b> Flexible Model:</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#lasso-model"><i class="fa fa-check"></i><b>1.3.3</b> Lasso Model:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#data-splitting"><i class="fa fa-check"></i><b>1.4</b> Data Splitting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html"><i class="fa fa-check"></i><b>2</b> Predictive Inference The Gender Wage Gap</a>
<ul>
<li class="chapter" data-level="2.1" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#data-analysis-1"><i class="fa fa-check"></i><b>2.1</b> Data analysis</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#ols-regression"><i class="fa fa-check"></i><b>2.1.1</b> OLS Regression</a></li>
<li class="chapter" data-level="2.1.2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#ols-regression-with-controls"><i class="fa fa-check"></i><b>2.1.2</b> Ols regression with controls</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#partialling-out-using-ols"><i class="fa fa-check"></i><b>2.2</b> Partialling-Out using ols</a></li>
<li class="chapter" data-level="2.3" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#partialling-out-using-lasso"><i class="fa fa-check"></i><b>2.3</b> Partialling-Out using lasso</a></li>
<li class="chapter" data-level="2.4" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#extra-flexible-model"><i class="fa fa-check"></i><b>2.4</b> “Extra” flexible model</a></li>
<li class="chapter" data-level="2.5" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#laso-extra-flexible-model"><i class="fa fa-check"></i><b>2.5</b> Laso “Extra” Flexible model</a></li>
<li class="chapter" data-level="2.6" data-path="predictive-inference-the-gender-wage-gap.html"><a href="predictive-inference-the-gender-wage-gap.html#summarize-the-results"><i class="fa fa-check"></i><b>2.6</b> Summarize the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html"><i class="fa fa-check"></i><b>3</b> Simple Exercise on Overfitting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#first-set-pn"><i class="fa fa-check"></i><b>3.1</b> 1. First set p=n</a></li>
<li class="chapter" data-level="3.2" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#second-set-pn2."><i class="fa fa-check"></i><b>3.2</b> 2. Second, set p=n/2.</a></li>
<li class="chapter" data-level="3.3" data-path="simple-exercise-on-overfitting.html"><a href="simple-exercise-on-overfitting.html#third-set-pn-.05"><i class="fa fa-check"></i><b>3.3</b> 3. Third, set p/n =.05</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html"><i class="fa fa-check"></i><b>4</b> Testing the Convergence Hypothesis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#data-analysis-2"><i class="fa fa-check"></i><b>4.2</b> Data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#ols"><i class="fa fa-check"></i><b>4.2.1</b> OLS</a></li>
<li class="chapter" data-level="4.2.2" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#lasso"><i class="fa fa-check"></i><b>4.2.2</b> Lasso</a></li>
<li class="chapter" data-level="4.2.3" data-path="testing-the-convergence-hypothesis.html"><a href="testing-the-convergence-hypothesis.html#summary-results"><i class="fa fa-check"></i><b>4.2.3</b> Summary results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulation-design.html"><a href="simulation-design.html"><i class="fa fa-check"></i><b>5</b> Simulation Design</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulation-design.html"><a href="simulation-design.html#example-1"><i class="fa fa-check"></i><b>5.1</b> Example 1</a></li>
<li class="chapter" data-level="5.2" data-path="simulation-design.html"><a href="simulation-design.html#example-2"><i class="fa fa-check"></i><b>5.2</b> Example 2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning and Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="testing-the-convergence-hypothesis" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Testing the Convergence Hypothesis</h1>
<div id="introduction" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>We provide an additional empirical example of partialling-out with Lasso to estimate the regression coefficient <span class="math inline">\(\beta_1\)</span> in the high-dimensional linear regression model:
<span class="math display">\[
  Y = \beta_1 D +  \beta_2&#39;W + \epsilon.
  \]</span></p>
<p>Specifically, we are interested in how the rates at which economies of different countries grow (<span class="math inline">\(Y\)</span>) are related to the initial wealth levels in each country (<span class="math inline">\(D\)</span>) controlling for country’s institutional, educational, and other similar characteristics (<span class="math inline">\(W\)</span>).</p>
<p>The relationship is captured by <span class="math inline">\(\beta_1\)</span>, the <em>speed of convergence/divergence</em>, which measures the speed at which poor countries catch up <span class="math inline">\((\beta_1&lt; 0)\)</span> or fall behind <span class="math inline">\((\beta_1&gt; 0)\)</span> rich countries, after controlling for <span class="math inline">\(W\)</span>. Our inference question here is: do poor countries grow faster than rich countries, controlling for educational and other characteristics? In other words, is the speed of convergence negative: $ _1 &lt;0?$ This is the Convergence Hypothesis predicted by the Solow Growth Model. This is a structural economic model. Under some strong assumptions, that we won’t state here, the predictive exercise we are doing here can be given causal interpretation.</p>
<p>The outcome <span class="math inline">\(Y\)</span> is the realized annual growth rate of a country’s wealth (Gross Domestic Product per capita). The target regressor (<span class="math inline">\(D\)</span>) is the initial level of the country’s wealth. The target parameter <span class="math inline">\(\beta_1\)</span> is the speed of convergence, which measures the speed at which poor countries catch up with rich countries. The controls (<span class="math inline">\(W\)</span>) include measures of education levels, quality of institutions, trade openness, and political stability in the country.</p>
<style>
  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }
  .col3 {
    columns: 3 100px;
    -webkit-columns: 3 100px;
    -moz-columns: 3 100px;
  }
</style>
</div>
<div id="data-analysis-2" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Data analysis</h2>
<p>We consider the data set GrowthData which is included in the package <em>hdm</em>. First, let us load the data set to get familiar with the data.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="testing-the-convergence-hypothesis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hdm)</span>
<span id="cb1-2"><a href="testing-the-convergence-hypothesis.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="testing-the-convergence-hypothesis.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="testing-the-convergence-hypothesis.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="testing-the-convergence-hypothesis.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyreadr</span>
<span id="cb2-4"><a href="testing-the-convergence-hypothesis.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb2-5"><a href="testing-the-convergence-hypothesis.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span></code></pre></div>
</div>
</div>
<p>Import data</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="testing-the-convergence-hypothesis.html#cb3-1" aria-hidden="true" tabindex="-1"></a>growth <span class="ot">&lt;-</span> GrowthData</span>
<span id="cb3-2"><a href="testing-the-convergence-hypothesis.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(growth)</span>
<span id="cb3-3"><a href="testing-the-convergence-hypothesis.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check variables</span></span>
<span id="cb3-4"><a href="testing-the-convergence-hypothesis.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(growth)</span></code></pre></div>
<pre><code>##  [1] &quot;Outcome&quot;   &quot;intercept&quot; &quot;gdpsh465&quot;  &quot;bmp1l&quot;     &quot;freeop&quot;    &quot;freetar&quot;  
##  [7] &quot;h65&quot;       &quot;hm65&quot;      &quot;hf65&quot;      &quot;p65&quot;       &quot;pm65&quot;      &quot;pf65&quot;     
## [13] &quot;s65&quot;       &quot;sm65&quot;      &quot;sf65&quot;      &quot;fert65&quot;    &quot;mort65&quot;    &quot;lifee065&quot; 
## [19] &quot;gpop1&quot;     &quot;fert1&quot;     &quot;mort1&quot;     &quot;invsh41&quot;   &quot;geetot1&quot;   &quot;geerec1&quot;  
## [25] &quot;gde1&quot;      &quot;govwb1&quot;    &quot;govsh41&quot;   &quot;gvxdxe41&quot;  &quot;high65&quot;    &quot;highm65&quot;  
## [31] &quot;highf65&quot;   &quot;highc65&quot;   &quot;highcm65&quot;  &quot;highcf65&quot;  &quot;human65&quot;   &quot;humanm65&quot; 
## [37] &quot;humanf65&quot;  &quot;hyr65&quot;     &quot;hyrm65&quot;    &quot;hyrf65&quot;    &quot;no65&quot;      &quot;nom65&quot;    
## [43] &quot;nof65&quot;     &quot;pinstab1&quot;  &quot;pop65&quot;     &quot;worker65&quot;  &quot;pop1565&quot;   &quot;pop6565&quot;  
## [49] &quot;sec65&quot;     &quot;secm65&quot;    &quot;secf65&quot;    &quot;secc65&quot;    &quot;seccm65&quot;   &quot;seccf65&quot;  
## [55] &quot;syr65&quot;     &quot;syrm65&quot;    &quot;syrf65&quot;    &quot;teapri65&quot;  &quot;teasec65&quot;  &quot;ex1&quot;      
## [61] &quot;im1&quot;       &quot;xr65&quot;      &quot;tot1&quot;</code></pre>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="testing-the-convergence-hypothesis.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I downloaded the data that the author used</span></span>
<span id="cb5-2"><a href="testing-the-convergence-hypothesis.html#cb5-2" aria-hidden="true" tabindex="-1"></a>growth_read <span class="op">=</span> pyreadr.read_r(<span class="st">&quot;./data/GrowthData.RData&quot;</span>)</span>
<span id="cb5-3"><a href="testing-the-convergence-hypothesis.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the data frame from rdata_read</span></span>
<span id="cb5-4"><a href="testing-the-convergence-hypothesis.html#cb5-4" aria-hidden="true" tabindex="-1"></a>growth <span class="op">=</span> growth_read[ <span class="st">&#39;GrowthData&#39;</span> ]</span>
<span id="cb5-5"><a href="testing-the-convergence-hypothesis.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check variables</span></span>
<span id="cb5-6"><a href="testing-the-convergence-hypothesis.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(growth)</span></code></pre></div>
<pre><code>## [&#39;Outcome&#39;, &#39;intercept&#39;, &#39;gdpsh465&#39;, &#39;bmp1l&#39;, &#39;freeop&#39;, &#39;freetar&#39;, &#39;h65&#39;, &#39;hm65&#39;, &#39;hf65&#39;, &#39;p65&#39;, &#39;pm65&#39;, &#39;pf65&#39;, &#39;s65&#39;, &#39;sm65&#39;, &#39;sf65&#39;, &#39;fert65&#39;, &#39;mort65&#39;, &#39;lifee065&#39;, &#39;gpop1&#39;, &#39;fert1&#39;, &#39;mort1&#39;, &#39;invsh41&#39;, &#39;geetot1&#39;, &#39;geerec1&#39;, &#39;gde1&#39;, &#39;govwb1&#39;, &#39;govsh41&#39;, &#39;gvxdxe41&#39;, &#39;high65&#39;, &#39;highm65&#39;, &#39;highf65&#39;, &#39;highc65&#39;, &#39;highcm65&#39;, &#39;highcf65&#39;, &#39;human65&#39;, &#39;humanm65&#39;, &#39;humanf65&#39;, &#39;hyr65&#39;, &#39;hyrm65&#39;, &#39;hyrf65&#39;, &#39;no65&#39;, &#39;nom65&#39;, &#39;nof65&#39;, &#39;pinstab1&#39;, &#39;pop65&#39;, &#39;worker65&#39;, &#39;pop1565&#39;, &#39;pop6565&#39;, &#39;sec65&#39;, &#39;secm65&#39;, &#39;secf65&#39;, &#39;secc65&#39;, &#39;seccm65&#39;, &#39;seccf65&#39;, &#39;syr65&#39;, &#39;syrm65&#39;, &#39;syrf65&#39;, &#39;teapri65&#39;, &#39;teasec65&#39;, &#39;ex1&#39;, &#39;im1&#39;, &#39;xr65&#39;, &#39;tot1&#39;]</code></pre>
</div>
</div>
<p>We determine the dimension of our data set.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="testing-the-convergence-hypothesis.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(growth)</span></code></pre></div>
<pre><code>## [1] 90 63</code></pre>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="testing-the-convergence-hypothesis.html#cb9-1" aria-hidden="true" tabindex="-1"></a>growth.shape</span></code></pre></div>
<pre><code>## (90, 63)</code></pre>
</div>
</div>
<div id="ols" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> OLS</h3>
<p>The sample contains <span class="math inline">\(90\)</span> countries and <span class="math inline">\(63\)</span> controls. Thus <span class="math inline">\(p \approx 60\)</span>, <span class="math inline">\(n=90\)</span> and <span class="math inline">\(p/n\)</span> is not small. We expect the least squares method to provide a poor estimate of <span class="math inline">\(\beta_1\)</span>. We expect the method based on partialling-out with Lasso to provide a high quality estimate of <span class="math inline">\(\beta_1\)</span>.
To check this hypothesis, we analyze the relation between the output variable <span class="math inline">\(Y\)</span> and the other country’s characteristics by running a linear regression in the first step.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="testing-the-convergence-hypothesis.html#cb11-1" aria-hidden="true" tabindex="-1"></a>reg.ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(Outcome<span class="sc">~</span>.<span class="sc">-</span><span class="dv">1</span>,<span class="at">data=</span>growth)</span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="testing-the-convergence-hypothesis.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We create the main variables</span></span>
<span id="cb12-2"><a href="testing-the-convergence-hypothesis.html#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> growth[<span class="st">&#39;Outcome&#39;</span>]</span>
<span id="cb12-3"><a href="testing-the-convergence-hypothesis.html#cb12-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> growth.drop(<span class="st">&#39;Outcome&#39;</span>, <span class="dv">1</span>)</span>
<span id="cb12-4"><a href="testing-the-convergence-hypothesis.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># OLS regression</span></span>
<span id="cb12-5"><a href="testing-the-convergence-hypothesis.html#cb12-5" aria-hidden="true" tabindex="-1"></a>reg_ols  <span class="op">=</span> sm.OLS(y, X).fit()</span></code></pre></div>
</div>
</div>
<p>We determine the regression coefficient <span class="math inline">\(\beta_1\)</span> of the target regressor <em>gdpsh465</em> (<span class="math inline">\(D\)</span>), its 95% confidence interval and the standard error.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="testing-the-convergence-hypothesis.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output: estimated regression coefficient corresponding to the target regressor</span></span>
<span id="cb13-2"><a href="testing-the-convergence-hypothesis.html#cb13-2" aria-hidden="true" tabindex="-1"></a>est_ols <span class="ot">&lt;-</span> <span class="fu">summary</span>(reg.ols)<span class="sc">$</span>coef[<span class="st">&quot;gdpsh465&quot;</span>,<span class="dv">1</span>]</span>
<span id="cb13-3"><a href="testing-the-convergence-hypothesis.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="testing-the-convergence-hypothesis.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># output: std. error</span></span>
<span id="cb13-5"><a href="testing-the-convergence-hypothesis.html#cb13-5" aria-hidden="true" tabindex="-1"></a>std_ols <span class="ot">&lt;-</span> <span class="fu">summary</span>(reg.ols)<span class="sc">$</span>coef[<span class="st">&quot;gdpsh465&quot;</span>,<span class="dv">2</span>]</span>
<span id="cb13-6"><a href="testing-the-convergence-hypothesis.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="testing-the-convergence-hypothesis.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># output: 95% confidence interval</span></span>
<span id="cb13-8"><a href="testing-the-convergence-hypothesis.html#cb13-8" aria-hidden="true" tabindex="-1"></a>ci_ols <span class="ot">&lt;-</span> <span class="fu">confint</span>(reg.ols)[<span class="dv">2</span>,]</span>
<span id="cb13-9"><a href="testing-the-convergence-hypothesis.html#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="testing-the-convergence-hypothesis.html#cb13-10" aria-hidden="true" tabindex="-1"></a>results_ols <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(est_ols,std_ols,ci_ols[<span class="dv">1</span>],ci_ols[<span class="dv">2</span>]))</span>
<span id="cb13-11"><a href="testing-the-convergence-hypothesis.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_ols) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;estimator&quot;</span>,<span class="st">&quot;standard error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>)</span>
<span id="cb13-12"><a href="testing-the-convergence-hypothesis.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results_ols) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;OLS&quot;</span>)</span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="testing-the-convergence-hypothesis.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output: estimated regression coefficient corresponding to the target regressor</span></span>
<span id="cb14-2"><a href="testing-the-convergence-hypothesis.html#cb14-2" aria-hidden="true" tabindex="-1"></a>est_ols <span class="op">=</span> reg_ols.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;Coef.&#39;</span>][<span class="st">&#39;gdpsh465&#39;</span>]</span>
<span id="cb14-3"><a href="testing-the-convergence-hypothesis.html#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="testing-the-convergence-hypothesis.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># output: std. error</span></span>
<span id="cb14-5"><a href="testing-the-convergence-hypothesis.html#cb14-5" aria-hidden="true" tabindex="-1"></a>std_ols <span class="op">=</span> reg_ols.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;Std.Err.&#39;</span>][<span class="st">&#39;gdpsh465&#39;</span>]</span>
<span id="cb14-6"><a href="testing-the-convergence-hypothesis.html#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="testing-the-convergence-hypothesis.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># output: 95% confidence interval</span></span>
<span id="cb14-8"><a href="testing-the-convergence-hypothesis.html#cb14-8" aria-hidden="true" tabindex="-1"></a>lower_ci <span class="op">=</span> reg_ols.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;[0.025&#39;</span>][<span class="st">&#39;gdpsh465&#39;</span>]</span>
<span id="cb14-9"><a href="testing-the-convergence-hypothesis.html#cb14-9" aria-hidden="true" tabindex="-1"></a>upper_ci <span class="op">=</span> reg_ols.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;0.975]&#39;</span>][<span class="st">&#39;gdpsh465&#39;</span>]</span></code></pre></div>
</div>
</div>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="testing-the-convergence-hypothesis.html#cb15-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb15-2"><a href="testing-the-convergence-hypothesis.html#cb15-2" aria-hidden="true" tabindex="-1"></a>table[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]   <span class="ot">&lt;-</span> <span class="fu">c</span>(est_ols,std_ols,ci_ols[<span class="dv">1</span>],ci_ols[<span class="dv">2</span>])</span>
<span id="cb15-3"><a href="testing-the-convergence-hypothesis.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;estimator&quot;</span>,<span class="st">&quot;standard error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>)</span>
<span id="cb15-4"><a href="testing-the-convergence-hypothesis.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;OLS&quot;</span>)</span>
<span id="cb15-5"><a href="testing-the-convergence-hypothesis.html#cb15-5" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">&lt;-</span> <span class="fu">xtable</span>(table, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb15-6"><a href="testing-the-convergence-hypothesis.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab,<span class="at">type=</span><span class="st">&quot;html&quot;</span>) <span class="co"># set type=&quot;latex&quot; for printing table in LaTeX</span></span></code></pre></div>
<pre><code>## &lt;!-- html table generated in R 4.1.1 by xtable 1.8-4 package --&gt;
## &lt;!-- Tue Sep 28 12:46:42 2021 --&gt;
## &lt;table border=1&gt;
## &lt;tr&gt; &lt;th&gt;  &lt;/th&gt; &lt;th&gt; estimator &lt;/th&gt; &lt;th&gt; standard error &lt;/th&gt; &lt;th&gt; lower bound CI &lt;/th&gt; &lt;th&gt; upper bound CI &lt;/th&gt;  &lt;/tr&gt;
##   &lt;tr&gt; &lt;td align=&quot;right&quot;&gt; OLS &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; -0.009 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 0.030 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; -0.071 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 0.052 &lt;/td&gt; &lt;/tr&gt;
##    &lt;/table&gt;</code></pre>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="testing-the-convergence-hypothesis.html#cb17-1" aria-hidden="true" tabindex="-1"></a>table_1 <span class="op">=</span> np.zeros( (<span class="dv">1</span>, <span class="dv">4</span>) )</span>
<span id="cb17-2"><a href="testing-the-convergence-hypothesis.html#cb17-2" aria-hidden="true" tabindex="-1"></a>table_1[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> est_ols  </span>
<span id="cb17-3"><a href="testing-the-convergence-hypothesis.html#cb17-3" aria-hidden="true" tabindex="-1"></a>table_1[<span class="dv">0</span>,<span class="dv">1</span>] <span class="op">=</span> std_ols   </span>
<span id="cb17-4"><a href="testing-the-convergence-hypothesis.html#cb17-4" aria-hidden="true" tabindex="-1"></a>table_1[<span class="dv">0</span>,<span class="dv">2</span>] <span class="op">=</span> lower_ci</span>
<span id="cb17-5"><a href="testing-the-convergence-hypothesis.html#cb17-5" aria-hidden="true" tabindex="-1"></a>table_1[<span class="dv">0</span>,<span class="dv">3</span>] <span class="op">=</span> upper_ci    </span>
<span id="cb17-6"><a href="testing-the-convergence-hypothesis.html#cb17-6" aria-hidden="true" tabindex="-1"></a>table_1_pandas <span class="op">=</span> pd.DataFrame( table_1, columns <span class="op">=</span> [ <span class="st">&quot;Estimator&quot;</span>,<span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>  ])</span>
<span id="cb17-7"><a href="testing-the-convergence-hypothesis.html#cb17-7" aria-hidden="true" tabindex="-1"></a>table_1_pandas.index <span class="op">=</span> [ <span class="st">&quot;OLS&quot;</span> ]</span>
<span id="cb17-8"><a href="testing-the-convergence-hypothesis.html#cb17-8" aria-hidden="true" tabindex="-1"></a>table_1_html <span class="op">=</span> table_1_pandas.to_html()</span>
<span id="cb17-9"><a href="testing-the-convergence-hypothesis.html#cb17-9" aria-hidden="true" tabindex="-1"></a>table_1_html</span></code></pre></div>
<pre><code>## &#39;&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;\n  &lt;thead&gt;\n    &lt;tr style=&quot;text-align: right;&quot;&gt;\n      &lt;th&gt;&lt;/th&gt;\n      &lt;th&gt;Estimator&lt;/th&gt;\n      &lt;th&gt;Std. Error&lt;/th&gt;\n      &lt;th&gt;lower bound CI&lt;/th&gt;\n      &lt;th&gt;upper bound CI&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n    &lt;tr&gt;\n      &lt;th&gt;OLS&lt;/th&gt;\n      &lt;td&gt;-0.009378&lt;/td&gt;\n      &lt;td&gt;0.029888&lt;/td&gt;\n      &lt;td&gt;-0.0706&lt;/td&gt;\n      &lt;td&gt;0.051844&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;&#39;</code></pre>
</div>
</div>
<!-- html table generated in R 3.6.3 by xtable 1.8-4 package -->
<!-- Tue Jan 19 10:23:32 2021 -->
<table border="1">
<tr>
<th>
</th>
<th>
estimator
</th>
<th>
standard error
</th>
<th>
lower bound CI
</th>
<th>
upper bound CI
</th>
</tr>
<tr>
<td align="right">
OLS
</td>
<td align="right">
-0.009
</td>
<td align="right">
0.030
</td>
<td align="right">
-0.071
</td>
<td align="right">
0.052
</td>
</tr>
</table>
</div>
<div id="lasso" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Lasso</h3>
<p>Least squares provides a rather noisy estimate (high standard error) of the
speed of convergence, and does not allow us to answer the question
about the convergence hypothesis since the confidence interval includes zero.
In contrast, we can use the partialling-out approach based on lasso regression (“Double Lasso”).</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="testing-the-convergence-hypothesis.html#cb19-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> growth[, <span class="dv">1</span>, drop <span class="ot">=</span> F] <span class="co"># output variable</span></span>
<span id="cb19-2"><a href="testing-the-convergence-hypothesis.html#cb19-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(growth)[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">3</span>)] <span class="co"># controls</span></span>
<span id="cb19-3"><a href="testing-the-convergence-hypothesis.html#cb19-3" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> growth[, <span class="dv">3</span>, drop <span class="ot">=</span> F] <span class="co"># target regressor</span></span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="testing-the-convergence-hypothesis.html#cb20-1" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> growth[<span class="st">&#39;Outcome&#39;</span>]</span>
<span id="cb20-2"><a href="testing-the-convergence-hypothesis.html#cb20-2" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> growth.drop([<span class="st">&#39;Outcome&#39;</span>,<span class="st">&#39;intercept&#39;</span>, <span class="st">&#39;gdpsh465&#39;</span>], <span class="dv">1</span> )</span>
<span id="cb20-3"><a href="testing-the-convergence-hypothesis.html#cb20-3" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> growth[<span class="st">&#39;gdpsh465&#39;</span>]</span></code></pre></div>
</div>
</div>
<p>we run the regression using lasso</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="testing-the-convergence-hypothesis.html#cb21-1" aria-hidden="true" tabindex="-1"></a>r.Y <span class="ot">&lt;-</span> <span class="fu">rlasso</span>(<span class="at">x=</span>W,<span class="at">y=</span>Y)<span class="sc">$</span>res <span class="co"># creates the &quot;residual&quot; output variable</span></span>
<span id="cb21-2"><a href="testing-the-convergence-hypothesis.html#cb21-2" aria-hidden="true" tabindex="-1"></a>r.D <span class="ot">&lt;-</span> <span class="fu">rlasso</span>(<span class="at">x=</span>W,<span class="at">y=</span>D)<span class="sc">$</span>res <span class="co"># creates the &quot;residual&quot; target regressor</span></span>
<span id="cb21-3"><a href="testing-the-convergence-hypothesis.html#cb21-3" aria-hidden="true" tabindex="-1"></a>partial.lasso <span class="ot">&lt;-</span> <span class="fu">lm</span>(r.Y <span class="sc">~</span> r.D)</span>
<span id="cb21-4"><a href="testing-the-convergence-hypothesis.html#cb21-4" aria-hidden="true" tabindex="-1"></a>est_lasso <span class="ot">&lt;-</span> partial.lasso<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb21-5"><a href="testing-the-convergence-hypothesis.html#cb21-5" aria-hidden="true" tabindex="-1"></a>std_lasso <span class="ot">&lt;-</span> <span class="fu">summary</span>(partial.lasso)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb21-6"><a href="testing-the-convergence-hypothesis.html#cb21-6" aria-hidden="true" tabindex="-1"></a>ci_lasso <span class="ot">&lt;-</span> <span class="fu">confint</span>(partial.lasso)[<span class="dv">2</span>,]</span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="testing-the-convergence-hypothesis.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb22-2"><a href="testing-the-convergence-hypothesis.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Seat values for Lasso</span></span>
<span id="cb22-3"><a href="testing-the-convergence-hypothesis.html#cb22-3" aria-hidden="true" tabindex="-1"></a>lasso_model <span class="op">=</span> linear_model.Lasso( alpha <span class="op">=</span> <span class="fl">0.00077</span> )</span>
<span id="cb22-4"><a href="testing-the-convergence-hypothesis.html#cb22-4" aria-hidden="true" tabindex="-1"></a>r_Y <span class="op">=</span> Y <span class="op">-</span> lasso_model.fit( W, Y ).predict( W )</span></code></pre></div>
<pre><code>## C:\Users\alexa\ANACON~1\envs\R-RETI~1\lib\site-packages\sklearn\linear_model\_coordinate_descent.py:532: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.005828894477391114, tolerance: 2.343497697571603e-05
##   positive)</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="testing-the-convergence-hypothesis.html#cb24-1" aria-hidden="true" tabindex="-1"></a>r_Y <span class="op">=</span> r_Y.rename(<span class="st">&#39;r_Y&#39;</span>)</span>
<span id="cb24-2"><a href="testing-the-convergence-hypothesis.html#cb24-2" aria-hidden="true" tabindex="-1"></a>r_D <span class="op">=</span> D <span class="op">-</span> lasso_model.fit( W, D ).predict( W ) <span class="co"># Part. out d</span></span></code></pre></div>
<pre><code>## C:\Users\alexa\ANACON~1\envs\R-RETI~1\lib\site-packages\sklearn\linear_model\_coordinate_descent.py:532: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations. Duality gap: 2.997244700077635, tolerance: 0.007147912790119585
##   positive)</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="testing-the-convergence-hypothesis.html#cb26-1" aria-hidden="true" tabindex="-1"></a>r_D <span class="op">=</span> r_D.rename(<span class="st">&#39;r_D&#39;</span>)</span>
<span id="cb26-2"><a href="testing-the-convergence-hypothesis.html#cb26-2" aria-hidden="true" tabindex="-1"></a>partial_lasso_fit <span class="op">=</span> sm.OLS(r_Y, r_D).fit() <span class="co"># Regress residuales</span></span>
<span id="cb26-3"><a href="testing-the-convergence-hypothesis.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="testing-the-convergence-hypothesis.html#cb26-4" aria-hidden="true" tabindex="-1"></a>est_lasso <span class="op">=</span> partial_lasso_fit.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;Coef.&#39;</span>][<span class="st">&#39;r_D&#39;</span>]</span>
<span id="cb26-5"><a href="testing-the-convergence-hypothesis.html#cb26-5" aria-hidden="true" tabindex="-1"></a>std_lasso <span class="op">=</span> partial_lasso_fit.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;Std.Err.&#39;</span>][<span class="st">&#39;r_D&#39;</span>]</span>
<span id="cb26-6"><a href="testing-the-convergence-hypothesis.html#cb26-6" aria-hidden="true" tabindex="-1"></a>lower_ci_lasso <span class="op">=</span> partial_lasso_fit.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;[0.025&#39;</span>][<span class="st">&#39;r_D&#39;</span>]</span>
<span id="cb26-7"><a href="testing-the-convergence-hypothesis.html#cb26-7" aria-hidden="true" tabindex="-1"></a>upper_ci_lasso <span class="op">=</span> partial_lasso_fit.summary2().tables[<span class="dv">1</span>][<span class="st">&#39;0.975]&#39;</span>][<span class="st">&#39;r_D&#39;</span>]</span></code></pre></div>
</div>
</div>
<p>now we export results into a table</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="testing-the-convergence-hypothesis.html#cb27-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb27-2"><a href="testing-the-convergence-hypothesis.html#cb27-2" aria-hidden="true" tabindex="-1"></a>table[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]   <span class="ot">&lt;-</span> <span class="fu">c</span>(est_lasso,std_lasso,ci_lasso[<span class="dv">1</span>],ci_lasso[<span class="dv">2</span>])</span>
<span id="cb27-3"><a href="testing-the-convergence-hypothesis.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;estimator&quot;</span>,<span class="st">&quot;standard error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>)</span>
<span id="cb27-4"><a href="testing-the-convergence-hypothesis.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Double Lasso&quot;</span>)</span>
<span id="cb27-5"><a href="testing-the-convergence-hypothesis.html#cb27-5" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">&lt;-</span> <span class="fu">xtable</span>(table, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb27-6"><a href="testing-the-convergence-hypothesis.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab,<span class="at">type=</span><span class="st">&quot;html&quot;</span>) <span class="co"># set type=&quot;latex&quot; for printing table in LaTeX</span></span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="testing-the-convergence-hypothesis.html#cb28-1" aria-hidden="true" tabindex="-1"></a>table_2 <span class="op">=</span> np.zeros( (<span class="dv">1</span>, <span class="dv">4</span>) )</span>
<span id="cb28-2"><a href="testing-the-convergence-hypothesis.html#cb28-2" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> est_lasso  </span>
<span id="cb28-3"><a href="testing-the-convergence-hypothesis.html#cb28-3" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">1</span>] <span class="op">=</span> std_lasso   </span>
<span id="cb28-4"><a href="testing-the-convergence-hypothesis.html#cb28-4" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">2</span>] <span class="op">=</span> lower_ci_lasso</span>
<span id="cb28-5"><a href="testing-the-convergence-hypothesis.html#cb28-5" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">3</span>] <span class="op">=</span> upper_ci_lasso    </span>
<span id="cb28-6"><a href="testing-the-convergence-hypothesis.html#cb28-6" aria-hidden="true" tabindex="-1"></a>table_2_pandas <span class="op">=</span> pd.DataFrame( table_2, columns <span class="op">=</span> [ <span class="st">&quot;Estimator&quot;</span>,<span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>  ])</span>
<span id="cb28-7"><a href="testing-the-convergence-hypothesis.html#cb28-7" aria-hidden="true" tabindex="-1"></a>table_2_pandas.index <span class="op">=</span> [ <span class="st">&quot;LASSO&quot;</span> ]</span>
<span id="cb28-8"><a href="testing-the-convergence-hypothesis.html#cb28-8" aria-hidden="true" tabindex="-1"></a>table_2_pandas</span></code></pre></div>
</div>
</div>
<!-- html table generated in R 3.6.3 by xtable 1.8-4 package -->
<!-- Tue Jan 19 10:23:51 2021 -->
<table border="1">
<tr>
<th>
</th>
<th>
estimator
</th>
<th>
standard error
</th>
<th>
lower bound CI
</th>
<th>
upper bound CI
</th>
</tr>
<tr>
<td align="right">
Double Lasso
</td>
<td align="right">
-0.050
</td>
<td align="right">
0.014
</td>
<td align="right">
-0.078
</td>
<td align="right">
-0.022
</td>
</tr>
</table>
<p>Lasso provides a more precise estimate (lower standard error). The Lasso based
point estimate is about <span class="math inline">\(5\%\)</span> and the <span class="math inline">\(95\%\)</span> confidence interval for the
(annual) rate of convergence is <span class="math inline">\(7.8\%\)</span> to <span class="math inline">\(2.2\%\)</span>. This empirical
evidence does support the convergence hypothesis.</p>
<p>Note: Alternatively, one could also use the <em>rlassoEffect</em> funtion from the <em>hdm</em> package that directly applies the partialling-out approach.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="testing-the-convergence-hypothesis.html#cb29-1" aria-hidden="true" tabindex="-1"></a>lasso.effect <span class="ot">=</span> <span class="fu">rlassoEffect</span>(<span class="at">x =</span> W, <span class="at">y =</span> Y, <span class="at">d =</span> D, <span class="at">method =</span> <span class="st">&quot;partialling out&quot;</span>)</span>
<span id="cb29-2"><a href="testing-the-convergence-hypothesis.html#cb29-2" aria-hidden="true" tabindex="-1"></a>lasso.effect</span></code></pre></div>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="testing-the-convergence-hypothesis.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;no package in python&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="summary-results" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Summary results</h3>
<p>Finally, let us have a look at the results.</p>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="testing-the-convergence-hypothesis.html#cb31-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb31-2"><a href="testing-the-convergence-hypothesis.html#cb31-2" aria-hidden="true" tabindex="-1"></a>table[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]   <span class="ot">&lt;-</span> <span class="fu">c</span>(est_ols,std_ols,ci_ols[<span class="dv">1</span>],ci_ols[<span class="dv">2</span>])</span>
<span id="cb31-3"><a href="testing-the-convergence-hypothesis.html#cb31-3" aria-hidden="true" tabindex="-1"></a>table[<span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]   <span class="ot">&lt;-</span> <span class="fu">c</span>(est_lasso,std_lasso,ci_lasso[<span class="dv">1</span>],ci_lasso[<span class="dv">2</span>])</span>
<span id="cb31-4"><a href="testing-the-convergence-hypothesis.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;estimator&quot;</span>,<span class="st">&quot;standard error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>)</span>
<span id="cb31-5"><a href="testing-the-convergence-hypothesis.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;OLS&quot;</span>,<span class="st">&quot;Double Lasso&quot;</span>)</span>
<span id="cb31-6"><a href="testing-the-convergence-hypothesis.html#cb31-6" aria-hidden="true" tabindex="-1"></a>tab<span class="ot">&lt;-</span> <span class="fu">xtable</span>(table, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb31-7"><a href="testing-the-convergence-hypothesis.html#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(tab,type=&quot;html&quot;) # set type=&quot;latex&quot; for printing table in LaTeX</span></span>
<span id="cb31-8"><a href="testing-the-convergence-hypothesis.html#cb31-8" aria-hidden="true" tabindex="-1"></a>table</span></code></pre></div>
<pre><code>##                 estimator standard error lower bound CI upper bound CI
## OLS          -0.009377989     0.02988773    -0.07060022     0.05184424
## Double Lasso -0.049811465     0.01393636    -0.07750705    -0.02211588</code></pre>
</div><div class="column" style="width:4%;">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="testing-the-convergence-hypothesis.html#cb33-1" aria-hidden="true" tabindex="-1"></a>table_2 <span class="op">=</span> np.zeros( (<span class="dv">1</span>, <span class="dv">4</span>) )</span>
<span id="cb33-2"><a href="testing-the-convergence-hypothesis.html#cb33-2" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> est_lasso  </span>
<span id="cb33-3"><a href="testing-the-convergence-hypothesis.html#cb33-3" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">1</span>] <span class="op">=</span> std_lasso   </span>
<span id="cb33-4"><a href="testing-the-convergence-hypothesis.html#cb33-4" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">2</span>] <span class="op">=</span> lower_ci_lasso</span>
<span id="cb33-5"><a href="testing-the-convergence-hypothesis.html#cb33-5" aria-hidden="true" tabindex="-1"></a>table_2[<span class="dv">0</span>,<span class="dv">3</span>] <span class="op">=</span> upper_ci_lasso    </span>
<span id="cb33-6"><a href="testing-the-convergence-hypothesis.html#cb33-6" aria-hidden="true" tabindex="-1"></a>table_2_pandas <span class="op">=</span> pd.DataFrame( table_2, columns <span class="op">=</span> [ <span class="st">&quot;Estimator&quot;</span>,<span class="st">&quot;Std. Error&quot;</span>, <span class="st">&quot;lower bound CI&quot;</span>, <span class="st">&quot;upper bound CI&quot;</span>  ])</span>
<span id="cb33-7"><a href="testing-the-convergence-hypothesis.html#cb33-7" aria-hidden="true" tabindex="-1"></a>table_2_pandas.index <span class="op">=</span> [ <span class="st">&quot;Double LASSO&quot;</span> ]</span>
<span id="cb33-8"><a href="testing-the-convergence-hypothesis.html#cb33-8" aria-hidden="true" tabindex="-1"></a>table_3 <span class="op">=</span> table_1_pandas.append(table_2_pandas)</span>
<span id="cb33-9"><a href="testing-the-convergence-hypothesis.html#cb33-9" aria-hidden="true" tabindex="-1"></a>table_3</span></code></pre></div>
<pre><code>##               Estimator  Std. Error  lower bound CI  upper bound CI
## OLS           -0.009378    0.029888       -0.070600        0.051844
## Double LASSO  -0.047747    0.017705       -0.082926       -0.012567</code></pre>
</div>
</div>
<p>The least square method provides a rather noisy estimate of the speed of convergence. We can not answer the question if poor countries grow faster than rich countries. The least square method does not work when the ratio <span class="math inline">\(p/n\)</span> is large.</p>
<p>In sharp contrast, partialling-out via Lasso provides a more precise estimate. The Lasso based point estimate is <span class="math inline">\(-5\%\)</span> and the <span class="math inline">\(95\%\)</span> confidence interval for the (annual) rate of convergence <span class="math inline">\([-7.8\%,-2.2\%]\)</span> only includes negative numbers. This empirical evidence does support the convergence hypothesis.</p>
<!-- html table generated in R 3.6.3 by xtable 1.8-4 package -->
<!-- Tue Jan 19 10:28:15 2021 -->
<table border="1">
<tr>
<th>
</th>
<th>
estimator
</th>
<th>
standard error
</th>
<th>
lower bound CI
</th>
<th>
upper bound CI
</th>
</tr>
<tr>
<td align="right">
OLS
</td>
<td align="right">
-0.009
</td>
<td align="right">
0.030
</td>
<td align="right">
-0.071
</td>
<td align="right">
0.052
</td>
</tr>
<tr>
<td align="right">
Double Lasso
</td>
<td align="right">
-0.050
</td>
<td align="right">
0.014
</td>
<td align="right">
-0.078
</td>
<td align="right">
-0.022
</td>
</tr>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-exercise-on-overfitting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulation-design.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexanderquispe/ml_book/edit/master/04-Convergence.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/alexanderquispe/ml_book/blob/master/04-Convergence.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
